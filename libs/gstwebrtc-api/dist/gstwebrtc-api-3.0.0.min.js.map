{"version":3,"file":"gstwebrtc-api-3.0.0.min.js","mappings":"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","sources":["webpack://gstwebrtc-api/webpack/bootstrap","webpack://gstwebrtc-api/webpack/runtime/define property getters","webpack://gstwebrtc-api/webpack/runtime/hasOwnProperty shorthand","webpack://gstwebrtc-api/webpack/runtime/make namespace object","webpack://gstwebrtc-api/./node_modules/webrtc-adapter/src/js/utils.js","webpack://gstwebrtc-api/./node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","webpack://gstwebrtc-api/./node_modules/webrtc-adapter/src/js/chrome/getdisplaymedia.js","webpack://gstwebrtc-api/./node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","webpack://gstwebrtc-api/./node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","webpack://gstwebrtc-api/./node_modules/webrtc-adapter/src/js/firefox/getdisplaymedia.js","webpack://gstwebrtc-api/./node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","webpack://gstwebrtc-api/./node_modules/webrtc-adapter/src/js/safari/safari_shim.js","webpack://gstwebrtc-api/./node_modules/sdp/sdp.js","webpack://gstwebrtc-api/./node_modules/webrtc-adapter/src/js/common_shim.js","webpack://gstwebrtc-api/./node_modules/webrtc-adapter/src/js/adapter_factory.js","webpack://gstwebrtc-api/./node_modules/webrtc-adapter/src/js/adapter_core.js","webpack://gstwebrtc-api/./src/config.js","webpack://gstwebrtc-api/./src/session-state.js","webpack://gstwebrtc-api/./src/webrtc-session.js","webpack://gstwebrtc-api/./src/keysyms.js","webpack://gstwebrtc-api/./src/remote-controller.js","webpack://gstwebrtc-api/./src/consumer-session.js","webpack://gstwebrtc-api/./src/producer-session.js","webpack://gstwebrtc-api/./src/com-channel.js","webpack://gstwebrtc-api/./src/gstwebrtc-api.js","webpack://gstwebrtc-api/./src/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nlet logDisabled_ = true;\nlet deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nexport function extractVersion(uastring, expr, pos) {\n  const match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nexport function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  const nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    const wrappedCallback = (e) => {\n      const modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        if (cb.handleEvent) {\n          cb.handleEvent(modifiedEvent);\n        } else {\n          cb(modifiedEvent);\n        }\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    if (!this._eventMap[eventNameToWrap]) {\n      this._eventMap[eventNameToWrap] = new Map();\n    }\n    this._eventMap[eventNameToWrap].set(cb, wrappedCallback);\n    return nativeAddEventListener.apply(this, [nativeEventName,\n      wrappedCallback]);\n  };\n\n  const nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\n        || !this._eventMap[eventNameToWrap]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    if (!this._eventMap[eventNameToWrap].has(cb)) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    const unwrappedCb = this._eventMap[eventNameToWrap].get(cb);\n    this._eventMap[eventNameToWrap].delete(cb);\n    if (this._eventMap[eventNameToWrap].size === 0) {\n      delete this._eventMap[eventNameToWrap];\n    }\n    if (Object.keys(this._eventMap).length === 0) {\n      delete this._eventMap;\n    }\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\n      unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap,\n          this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap,\n          this['_on' + eventNameToWrap] = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n}\n\nexport function disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return (bool) ? 'adapter.js logging disabled' :\n    'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nexport function disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\n\nexport function log() {\n  if (typeof window === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nexport function deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\n      ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nexport function detectBrowser(window) {\n  // Returned result object.\n  const result = {browser: null, version: null};\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator ||\n      !window.navigator.userAgent) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n\n  const {navigator} = window;\n\n  if (navigator.mozGetUserMedia) { // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent,\n      /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia ||\n      (window.isSecureContext === false && window.webkitRTCPeerConnection)) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n    // more complicated fallback to webkitRTCPeerConnection.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent,\n      /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (window.RTCPeerConnection &&\n      navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) { // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent,\n      /AppleWebKit\\/(\\d+)\\./, 1);\n    result.supportsUnifiedPlan = window.RTCRtpTransceiver &&\n        'currentDirection' in window.RTCRtpTransceiver.prototype;\n  } else { // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n}\n\n/**\n * Checks if something is an object.\n *\n * @param {*} val The something you want to check.\n * @return true if val is an object, false otherwise.\n */\nfunction isObject(val) {\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nexport function compactObject(data) {\n  if (!isObject(data)) {\n    return data;\n  }\n\n  return Object.keys(data).reduce(function(accumulator, key) {\n    const isObj = isObject(data[key]);\n    const value = isObj ? compactObject(data[key]) : data[key];\n    const isEmptyObject = isObj && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n    return Object.assign(accumulator, {[key]: value});\n  }, {});\n}\n\n/* iterates the stats graph recursively. */\nexport function walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(name => {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(id => {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nexport function filterStats(result, track, outbound) {\n  const streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  const filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  const trackStats = [];\n  result.forEach(value => {\n    if (value.type === 'track' &&\n        value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(trackStat => {\n    result.forEach(stats => {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\nconst logging = utils.log;\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n\n  if (!navigator.mediaDevices) {\n    return;\n  }\n\n  const constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    const cc = {};\n    Object.keys(c).forEach(key => {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      const r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      const oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        let oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(mix => {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  const shimConstraints_ = function(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && typeof constraints.audio === 'object') {\n      const remap = function(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      let face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      const getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        let matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n            .then(devices => {\n              devices = devices.filter(d => d.kind === 'videoinput');\n              let dev = devices.find(d => matches.some(match =>\n                d.label.toLowerCase().includes(match)));\n              if (!dev && devices.length && matches.includes('back')) {\n                dev = devices[devices.length - 1]; // more likely the back cam\n              }\n              if (dev) {\n                constraints.video.deviceId = face.exact\n                  ? {exact: dev.deviceId}\n                  : {ideal: dev.deviceId};\n              }\n              constraints.video = constraintsToChrome_(constraints.video);\n              logging('chrome: ' + JSON.stringify(constraints));\n              return func(constraints);\n            });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  const shimError_ = function(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  const getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, c => {\n      navigator.webkitGetUserMedia(c, onSuccess, e => {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  if (navigator.mediaDevices.getUserMedia) {\n    const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, c => origGetUserMedia(c).then(stream => {\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(track => {\n            track.stop();\n          });\n          throw new DOMException('', 'NotFoundError');\n        }\n        return stream;\n      }, e => Promise.reject(shimError_(e))));\n    };\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nexport function shimGetDisplayMedia(window, getSourceId) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  // getSourceId is a function that returns a promise resolving with\n  // the sourceId of the screen/window/tab to be shared.\n  if (typeof getSourceId !== 'function') {\n    console.error('shimGetDisplayMedia: getSourceId argument is not ' +\n        'a function');\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      return getSourceId(constraints)\n        .then(sourceId => {\n          const widthSpecified = constraints.video && constraints.video.width;\n          const heightSpecified = constraints.video &&\n            constraints.video.height;\n          const frameRateSpecified = constraints.video &&\n            constraints.video.frameRate;\n          constraints.video = {\n            mandatory: {\n              chromeMediaSource: 'desktop',\n              chromeMediaSourceId: sourceId,\n              maxFrameRate: frameRateSpecified || 3\n            }\n          };\n          if (widthSpecified) {\n            constraints.video.mandatory.maxWidth = widthSpecified;\n          }\n          if (heightSpecified) {\n            constraints.video.mandatory.maxHeight = heightSpecified;\n          }\n          return window.navigator.mediaDevices.getUserMedia(constraints);\n        });\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n      window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get() {\n        return this._ontrack;\n      },\n      set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n      enumerable: true,\n      configurable: true\n    });\n    const origSetRemoteDescription =\n        window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        if (!this._ontrackpoly) {\n          this._ontrackpoly = (e) => {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', te => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === te.track.id);\n              } else {\n                receiver = {track: te.track};\n              }\n\n              const event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(track => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === track.id);\n              } else {\n                receiver = {track};\n              }\n              const event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n          };\n          this.addEventListener('addstream', this._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(this, arguments);\n      };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver',\n          {value: {receiver: e.receiver}});\n      }\n      return e;\n    });\n  }\n}\n\nexport function shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if (typeof window === 'object' && window.RTCPeerConnection &&\n      !('getSenders' in window.RTCPeerConnection.prototype) &&\n      'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    const shimSenderWithDtmf = function(pc, track) {\n      return {\n        track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n      const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack =\n        function addTrack(track, stream) {\n          let sender = origAddTrack.apply(this, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(this, track);\n            this._senders.push(sender);\n          }\n          return sender;\n        };\n\n      const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack =\n        function removeTrack(sender) {\n          origRemoveTrack.apply(this, arguments);\n          const idx = this._senders.indexOf(sender);\n          if (idx !== -1) {\n            this._senders.splice(idx, 1);\n          }\n        };\n    }\n    const origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(track => {\n        this._senders.push(shimSenderWithDtmf(this, track));\n      });\n    };\n\n    const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        this._senders = this._senders || [];\n        origRemoveStream.apply(this, [stream]);\n\n        stream.getTracks().forEach(track => {\n          const sender = this._senders.find(s => s.track === track);\n          if (sender) { // remove sender\n            this._senders.splice(this._senders.indexOf(sender), 1);\n          }\n        });\n      };\n  } else if (typeof window === 'object' && window.RTCPeerConnection &&\n             'getSenders' in window.RTCPeerConnection.prototype &&\n             'createDTMFSender' in window.RTCPeerConnection.prototype &&\n             window.RTCRtpSender &&\n             !('dtmf' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\n\nexport function shimGetStats(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n\n    // If selector is a function then we are in the old style stats so just\n    // pass back the original getStats format to avoid breaking old users.\n    if (arguments.length > 0 && typeof selector === 'function') {\n      return origGetStats.apply(this, arguments);\n    }\n\n    // When spec-style getStats is supported, return those when called with\n    // either no arguments or the selector argument is null.\n    if (origGetStats.length === 0 && (arguments.length === 0 ||\n        typeof selector !== 'function')) {\n      return origGetStats.apply(this, []);\n    }\n\n    const fixChromeStats_ = function(response) {\n      const standardReport = {};\n      const reports = response.result();\n      reports.forEach(report => {\n        const standardStats = {\n          id: report.id,\n          timestamp: report.timestamp,\n          type: {\n            localcandidate: 'local-candidate',\n            remotecandidate: 'remote-candidate'\n          }[report.type] || report.type\n        };\n        report.names().forEach(name => {\n          standardStats[name] = report.stat(name);\n        });\n        standardReport[standardStats.id] = standardStats;\n      });\n\n      return standardReport;\n    };\n\n    // shim getStats with maplike support\n    const makeMapStats = function(stats) {\n      return new Map(Object.keys(stats).map(key => [key, stats[key]]));\n    };\n\n    if (arguments.length >= 2) {\n      const successCallbackWrapper_ = function(response) {\n        onSucc(makeMapStats(fixChromeStats_(response)));\n      };\n\n      return origGetStats.apply(this, [successCallbackWrapper_,\n        selector]);\n    }\n\n    // promise-support\n    return new Promise((resolve, reject) => {\n      origGetStats.apply(this, [\n        function(response) {\n          resolve(makeMapStats(fixChromeStats_(response)));\n        }, reject]);\n    }).then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        const senders = origGetSenders.apply(this, []);\n        senders.forEach(sender => sender._pc = this);\n        return senders;\n      };\n    }\n\n    const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n        const sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function getStats() {\n      const sender = this;\n      return this._pc.getStats().then(result =>\n        /* Note: this will include stats of all senders that\n         *   send a track with the same id as sender.track as\n         *   it is not possible to identify the RTCRtpSender.\n         */\n        utils.filterStats(result, sender.track, true));\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers =\n        function getReceivers() {\n          const receivers = origGetReceivers.apply(this, []);\n          receivers.forEach(receiver => receiver._pc = this);\n          return receivers;\n        };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function getStats() {\n      const receiver = this;\n      return this._pc.getStats().then(result =>\n        utils.filterStats(result, receiver.track, false));\n    };\n  }\n\n  if (!('getStats' in window.RTCRtpSender.prototype &&\n      'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    if (arguments.length > 0 &&\n        arguments[0] instanceof window.MediaStreamTrack) {\n      const track = arguments[0];\n      let sender;\n      let receiver;\n      let err;\n      this.getSenders().forEach(s => {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(r => {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || (sender && receiver)) {\n        return Promise.reject(new DOMException(\n          'There are more than one sender or receiver for the track.',\n          'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException(\n        'There is no sender or receiver for the track.',\n        'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\n\nexport function shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      return Object.keys(this._shimmedLocalStreams)\n        .map(streamId => this._shimmedLocalStreams[streamId][0]);\n    };\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (!stream) {\n        return origAddTrack.apply(this, arguments);\n      }\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      const sender = origAddTrack.apply(this, arguments);\n      if (!this._shimmedLocalStreams[stream.id]) {\n        this._shimmedLocalStreams[stream.id] = [stream, sender];\n      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n        this._shimmedLocalStreams[stream.id].push(sender);\n      }\n      return sender;\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n    });\n    const existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    const newSenders = this.getSenders()\n      .filter(newSender => existingSenders.indexOf(newSender) === -1);\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      delete this._shimmedLocalStreams[stream.id];\n      return origRemoveStream.apply(this, arguments);\n    };\n\n  const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      if (sender) {\n        Object.keys(this._shimmedLocalStreams).forEach(streamId => {\n          const idx = this._shimmedLocalStreams[streamId].indexOf(sender);\n          if (idx !== -1) {\n            this._shimmedLocalStreams[streamId].splice(idx, 1);\n          }\n          if (this._shimmedLocalStreams[streamId].length === 1) {\n            delete this._shimmedLocalStreams[streamId];\n          }\n        });\n      }\n      return origRemoveTrack.apply(this, arguments);\n    };\n}\n\nexport function shimAddTrackRemoveTrack(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack &&\n      browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  const origGetLocalStreams = window.RTCPeerConnection.prototype\n    .getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      const nativeStreams = origGetLocalStreams.apply(this);\n      this._reverseStreams = this._reverseStreams || {};\n      return nativeStreams.map(stream => this._reverseStreams[stream.id]);\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      const newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n\n      origRemoveStream.apply(this, [(this._streams[stream.id] || stream)]);\n      delete this._reverseStreams[(this._streams[stream.id] ?\n        this._streams[stream.id].id : stream.id)];\n      delete this._streams[stream.id];\n    };\n\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      const streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 ||\n          !streams[0].getTracks().find(t => t === track)) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException(\n          'The adapter.js addTrack polyfill only supports a single ' +\n          ' stream which is associated with the specified track.',\n          'NotSupportedError');\n      }\n\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n          'InvalidAccessError');\n      }\n\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n      const oldStream = this._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(() => {\n          this.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        const newStream = new window.MediaStream([track]);\n        this._streams[stream.id] = newStream;\n        this._reverseStreams[newStream.id] = stream;\n        this.addStream(newStream);\n      }\n      return this.getSenders().find(s => s.track === track);\n    };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\n        externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\n        internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function(method) {\n    const nativeMethod = window.RTCPeerConnection.prototype[method];\n    const methodObj = {[method]() {\n      const args = arguments;\n      const isLegacyCall = arguments.length &&\n          typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [\n          (description) => {\n            const desc = replaceInternalStreamId(this, description);\n            args[0].apply(null, [desc]);\n          },\n          (err) => {\n            if (args[1]) {\n              args[1].apply(null, err);\n            }\n          }, arguments[2]\n        ]);\n      }\n      return nativeMethod.apply(this, arguments)\n        .then(description => replaceInternalStreamId(this, description));\n    }};\n    window.RTCPeerConnection.prototype[method] = methodObj[method];\n  });\n\n  const origSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(this, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(this, arguments[0]);\n      return origSetLocalDescription.apply(this, arguments);\n    };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  const origLocalDescription = Object.getOwnPropertyDescriptor(\n    window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype,\n    'localDescription', {\n      get() {\n        const description = origLocalDescription.get.apply(this);\n        if (description.type === '') {\n          return description;\n        }\n        return replaceInternalStreamId(this, description);\n      }\n    });\n\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\n            'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      const isLocal = sender._pc === this;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.',\n          'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      this._streams = this._streams || {};\n      let stream;\n      Object.keys(this._streams).forEach(streamid => {\n        const hasTrack = this._streams[streamid].getTracks()\n          .find(track => sender.track === track);\n        if (hasTrack) {\n          stream = this._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          this.removeStream(this._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        this.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  if (browserDetails.version < 53) {\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n      .forEach(function(method) {\n        const nativeMethod = window.RTCPeerConnection.prototype[method];\n        const methodObj = {[method]() {\n          arguments[0] = new ((method === 'addIceCandidate') ?\n            window.RTCIceCandidate :\n            window.RTCSessionDescription)(arguments[0]);\n          return nativeMethod.apply(this, arguments);\n        }};\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n  }\n}\n\n// Attempt to fix ONN in plan-b mode.\nexport function fixNegotiationNeeded(window, browserDetails) {\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', e => {\n    const pc = e.target;\n    if (browserDetails.version < 72 || (pc.getConfiguration &&\n        pc.getConfiguration().sdpSemantics === 'plan-b')) {\n      if (pc.signalingState !== 'stable') {\n        return;\n      }\n    }\n    return e;\n  });\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n  const MediaStreamTrack = window && window.MediaStreamTrack;\n\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia',\n      'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n\n  if (!(browserDetails.version > 55 &&\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    const remap = function(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    const nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      if (typeof c === 'object' && typeof c.audio === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      const nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function() {\n        const obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      const nativeApplyConstraints =\n        MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\n        if (this.kind === 'audio' && typeof c === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      if (!(constraints && constraints.video)) {\n        const err = new DOMException('getDisplayMedia without video ' +\n            'constraints is undefined');\n        err.name = 'NotFoundError';\n        // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n        err.code = 8;\n        return Promise.reject(err);\n      }\n      if (constraints.video === true) {\n        constraints.video = {mediaSource: preferredMediaSource};\n      } else {\n        constraints.video.mediaSource = preferredMediaSource;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      ('receiver' in window.RTCTrackEvent.prototype) &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (typeof window !== 'object' ||\n      !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n      .forEach(function(method) {\n        const nativeMethod = window.RTCPeerConnection.prototype[method];\n        const methodObj = {[method]() {\n          arguments[0] = new ((method === 'addIceCandidate') ?\n            window.RTCIceCandidate :\n            window.RTCSessionDescription)(arguments[0]);\n          return nativeMethod.apply(this, arguments);\n        }};\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n  }\n\n  const modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  const nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n    return nativeGetStats.apply(this, [selector || null])\n      .then(stats => {\n        if (browserDetails.version < 53 && !onSucc) {\n          // Shim only promise getStats with spec-hyphens in type names\n          // Leave callback version alone; misc old uses of forEach before Map\n          try {\n            stats.forEach(stat => {\n              stat.type = modernStatsTypes[stat.type] || stat.type;\n            });\n          } catch (e) {\n            if (e.name !== 'TypeError') {\n              throw e;\n            }\n            // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n            stats.forEach((stat, i) => {\n              stats.set(i, Object.assign({}, stat, {\n                type: modernStatsTypes[stat.type] || stat.type\n              }));\n            });\n          }\n        }\n        return stats;\n      })\n      .then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n  }\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      const sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) :\n      Promise.resolve(new Map());\n  };\n}\n\nexport function shimReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      const receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(receiver => receiver._pc = this);\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', e => {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\n\nexport function shimRemoveStream(window) {\n  if (!window.RTCPeerConnection ||\n      'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(sender => {\n        if (sender.track && stream.getTracks().includes(sender.track)) {\n          this.removeTrack(sender);\n        }\n      });\n    };\n}\n\nexport function shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\nexport function shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver =\n      function addTransceiver() {\n        this.setParametersPromises = [];\n        // WebIDL input coercion and validation\n        let sendEncodings = arguments[1] && arguments[1].sendEncodings;\n        if (sendEncodings === undefined) {\n          sendEncodings = [];\n        }\n        sendEncodings = [...sendEncodings];\n        const shouldPerformCheck = sendEncodings.length > 0;\n        if (shouldPerformCheck) {\n          // If sendEncodings params are provided, validate grammar\n          sendEncodings.forEach((encodingParam) => {\n            if ('rid' in encodingParam) {\n              const ridRegex = /^[a-z0-9]{0,16}$/i;\n              if (!ridRegex.test(encodingParam.rid)) {\n                throw new TypeError('Invalid RID value provided.');\n              }\n            }\n            if ('scaleResolutionDownBy' in encodingParam) {\n              if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n                throw new RangeError('scale_resolution_down_by must be >= 1.0');\n              }\n            }\n            if ('maxFramerate' in encodingParam) {\n              if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n                throw new RangeError('max_framerate must be >= 0.0');\n              }\n            }\n          });\n        }\n        const transceiver = origAddTransceiver.apply(this, arguments);\n        if (shouldPerformCheck) {\n          // Check if the init options were applied. If not we do this in an\n          // asynchronous way and save the promise reference in a global object.\n          // This is an ugly hack, but at the same time is way more robust than\n          // checking the sender parameters before and after the createOffer\n          // Also note that after the createoffer we are not 100% sure that\n          // the params were asynchronously applied so we might miss the\n          // opportunity to recreate offer.\n          const {sender} = transceiver;\n          const params = sender.getParameters();\n          if (!('encodings' in params) ||\n              // Avoid being fooled by patched getParameters() below.\n              (params.encodings.length === 1 &&\n               Object.keys(params.encodings[0]).length === 0)) {\n            params.encodings = sendEncodings;\n            sender.sendEncodings = sendEncodings;\n            this.setParametersPromises.push(sender.setParameters(params)\n              .then(() => {\n                delete sender.sendEncodings;\n              }).catch(() => {\n                delete sender.sendEncodings;\n              })\n            );\n          }\n        }\n        return transceiver;\n      };\n  }\n}\n\nexport function shimGetParameters(window) {\n  if (!(typeof window === 'object' && window.RTCRtpSender)) {\n    return;\n  }\n  const origGetParameters = window.RTCRtpSender.prototype.getParameters;\n  if (origGetParameters) {\n    window.RTCRtpSender.prototype.getParameters =\n      function getParameters() {\n        const params = origGetParameters.apply(this, arguments);\n        if (!('encodings' in params)) {\n          params.encodings = [].concat(this.sendEncodings || [{}]);\n        }\n        return params;\n      };\n  }\n}\n\nexport function shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n        .then(() => {\n          return origCreateOffer.apply(this, arguments);\n        })\n        .finally(() => {\n          this.setParametersPromises = [];\n        });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\nexport function shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n        .then(() => {\n          return origCreateAnswer.apply(this, arguments);\n        })\n        .finally(() => {\n          this.setParametersPromises = [];\n        });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nimport * as utils from '../utils';\n\nexport function shimLocalStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams =\n      function getLocalStreams() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    const _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      // Try to emulate Chrome's behaviour of adding in audio-video order.\n      // Safari orders by track id.\n      stream.getAudioTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n      stream.getVideoTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n    };\n\n    window.RTCPeerConnection.prototype.addTrack =\n      function addTrack(track, ...streams) {\n        if (streams) {\n          streams.forEach((stream) => {\n            if (!this._localStreams) {\n              this._localStreams = [stream];\n            } else if (!this._localStreams.includes(stream)) {\n              this._localStreams.push(stream);\n            }\n          });\n        }\n        return _addTrack.apply(this, arguments);\n      };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        const index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        const tracks = stream.getTracks();\n        this.getSenders().forEach(sender => {\n          if (tracks.includes(sender.track)) {\n            this.removeTrack(sender);\n          }\n        });\n      };\n  }\n}\n\nexport function shimRemoteStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams =\n      function getRemoteStreams() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get() {\n        return this._onaddstream;\n      },\n      set(f) {\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = (e) => {\n          e.streams.forEach(stream => {\n            if (!this._remoteStreams) {\n              this._remoteStreams = [];\n            }\n            if (this._remoteStreams.includes(stream)) {\n              return;\n            }\n            this._remoteStreams.push(stream);\n            const event = new Event('addstream');\n            event.stream = stream;\n            this.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        const pc = this;\n        if (!this._onaddstreampoly) {\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            e.streams.forEach(stream => {\n              if (!pc._remoteStreams) {\n                pc._remoteStreams = [];\n              }\n              if (pc._remoteStreams.indexOf(stream) >= 0) {\n                return;\n              }\n              pc._remoteStreams.push(stream);\n              const event = new Event('addstream');\n              event.stream = stream;\n              pc.dispatchEvent(event);\n            });\n          });\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n  }\n}\n\nexport function shimCallbacksAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  const prototype = window.RTCPeerConnection.prototype;\n  const origCreateOffer = prototype.createOffer;\n  const origCreateAnswer = prototype.createAnswer;\n  const setLocalDescription = prototype.setLocalDescription;\n  const setRemoteDescription = prototype.setRemoteDescription;\n  const addIceCandidate = prototype.addIceCandidate;\n\n  prototype.createOffer =\n    function createOffer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  prototype.createAnswer =\n    function createAnswer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  let withCallback = function(description, successCallback, failureCallback) {\n    const promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n\n  withCallback = function(description, successCallback, failureCallback) {\n    const promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n\n  withCallback = function(candidate, successCallback, failureCallback) {\n    const promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    const mediaDevices = navigator.mediaDevices;\n    const _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = (constraints) => {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n\n  if (!navigator.getUserMedia && navigator.mediaDevices &&\n    navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints)\n        .then(cb, errcb);\n    }.bind(navigator);\n  }\n}\n\nexport function shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({},\n      constraints,\n      {video: utils.compactObject(constraints.video)}\n    );\n  }\n\n  return constraints;\n}\n\nexport function shimRTCIceServerUrls(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  const OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection =\n    function RTCPeerConnection(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        const newIceServers = [];\n        for (let i = 0; i < pcConfig.iceServers.length; i++) {\n          let server = pcConfig.iceServers[i];\n          if (server.urls === undefined && server.url) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in OrigPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\n\nexport function shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      'receiver' in window.RTCTrackEvent.prototype &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimCreateOfferLegacy(window) {\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer =\n    function createOffer(offerOptions) {\n      if (offerOptions) {\n        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveAudio =\n            !!offerOptions.offerToReceiveAudio;\n        }\n        const audioTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'audio');\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('sendonly');\n            } else {\n              audioTransceiver.direction = 'sendonly';\n            }\n          } else if (audioTransceiver.direction === 'recvonly') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('inactive');\n            } else {\n              audioTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveAudio === true &&\n            !audioTransceiver) {\n          this.addTransceiver('audio', {direction: 'recvonly'});\n        }\n\n        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveVideo =\n            !!offerOptions.offerToReceiveVideo;\n        }\n        const videoTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'video');\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('sendonly');\n            } else {\n              videoTransceiver.direction = 'sendonly';\n            }\n          } else if (videoTransceiver.direction === 'recvonly') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('inactive');\n            } else {\n              videoTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveVideo === true &&\n            !videoTransceiver) {\n          this.addTransceiver('video', {direction: 'recvonly'});\n        }\n      }\n      return origCreateOffer.apply(this, arguments);\n    };\n}\n\nexport function shimAudioContext(window) {\n  if (typeof window !== 'object' || window.AudioContext) {\n    return;\n  }\n  window.AudioContext = window.webkitAudioContext;\n}\n\n","/* eslint-env node */\n'use strict';\n\n// SDP helpers.\nconst SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substring(2, 12);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(line => line.trim());\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  const parts = blob.split('\\nm=');\n  return parts.map((part, index) => (index > 0 ?\n    'm=' + part : part).trim() + '\\r\\n');\n};\n\n// Returns the session description.\nSDPUtils.getDescription = function(blob) {\n  const sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// Returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  const sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(line => line.indexOf(prefix) === 0);\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\n// Input can be prefixed with a=.\nSDPUtils.parseCandidate = function(line) {\n  let parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  const candidate = {\n    foundation: parts[0],\n    component: {1: 'rtp', 2: 'rtcp'}[parts[1]] || parts[1],\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7],\n  };\n\n  for (let i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compatibility.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag. Don't overwrite.\n        if (candidate[parts[i]] === undefined) {\n          candidate[parts[i]] = parts[i + 1];\n        }\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\n// This does not include the a= prefix!\nSDPUtils.writeCandidate = function(candidate) {\n  const sdp = [];\n  sdp.push(candidate.foundation);\n\n  const component = candidate.component;\n  if (component === 'rtp') {\n    sdp.push(1);\n  } else if (component === 'rtcp') {\n    sdp.push(2);\n  } else {\n    sdp.push(component);\n  }\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  const type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// Sample input:\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substring(14).split(' ');\n};\n\n// Parses a rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  let parts = line.substring(9).split(' ');\n  const parsed = {\n    payloadType: parseInt(parts.shift(), 10), // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generates a rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  const channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses a extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  const parts = line.substring(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1],\n    attributes: parts.slice(2).join(' '),\n  };\n};\n\n// Generates an extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n        ? '/' + headerExtension.direction\n        : '') +\n      ' ' + headerExtension.uri +\n      (headerExtension.attributes ? ' ' + headerExtension.attributes : '') +\n      '\\r\\n';\n};\n\n// Parses a fmtp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  const parsed = {};\n  let kv;\n  const parts = line.substring(line.indexOf(' ') + 1).split(';');\n  for (let j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates a fmtp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  let line = '';\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    const params = [];\n    Object.keys(codec.parameters).forEach(param => {\n      if (codec.parameters[param] !== undefined) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses a rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  const parts = line.substring(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' '),\n  };\n};\n\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  let lines = '';\n  let pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(fb => {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses a RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  const sp = line.indexOf(' ');\n  const parts = {\n    ssrc: parseInt(line.substring(7, sp), 10),\n  };\n  const colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substring(sp + 1, colon);\n    parts.value = line.substring(colon + 1);\n  } else {\n    parts.attribute = line.substring(sp + 1);\n  }\n  return parts;\n};\n\n// Parse a ssrc-group line (see RFC 5576). Sample input:\n// a=ssrc-group:semantics 12 34\nSDPUtils.parseSsrcGroup = function(line) {\n  const parts = line.substring(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(ssrc => parseInt(ssrc, 10)),\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// Returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  const mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substring(6);\n  }\n};\n\n// Parses a fingerprint line for DTLS-SRTP.\nSDPUtils.parseFingerprint = function(line) {\n  const parts = line.substring(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1].toUpperCase(), // the definition is upper-case in RFC 4572.\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  const lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint),\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  let sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(fp => {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n\n// Parses a=crypto lines into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\nSDPUtils.parseCryptoLine = function(line) {\n  const parts = line.substring(9).split(' ');\n  return {\n    tag: parseInt(parts[0], 10),\n    cryptoSuite: parts[1],\n    keyParams: parts[2],\n    sessionParams: parts.slice(3),\n  };\n};\n\nSDPUtils.writeCryptoLine = function(parameters) {\n  return 'a=crypto:' + parameters.tag + ' ' +\n    parameters.cryptoSuite + ' ' +\n    (typeof parameters.keyParams === 'object'\n      ? SDPUtils.writeCryptoKeyParams(parameters.keyParams)\n      : parameters.keyParams) +\n    (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') +\n    '\\r\\n';\n};\n\n// Parses the crypto key parameters into\n//   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\nSDPUtils.parseCryptoKeyParams = function(keyParams) {\n  if (keyParams.indexOf('inline:') !== 0) {\n    return null;\n  }\n  const parts = keyParams.substring(7).split('|');\n  return {\n    keyMethod: 'inline',\n    keySalt: parts[0],\n    lifeTime: parts[1],\n    mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\n    mkiLength: parts[2] ? parts[2].split(':')[1] : undefined,\n  };\n};\n\nSDPUtils.writeCryptoKeyParams = function(keyParams) {\n  return keyParams.keyMethod + ':'\n    + keyParams.keySalt +\n    (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') +\n    (keyParams.mkiValue && keyParams.mkiLength\n      ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength\n      : '');\n};\n\n// Extracts all SDES parameters.\nSDPUtils.getCryptoParameters = function(mediaSection, sessionpart) {\n  const lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=crypto:');\n  return lines.map(SDPUtils.parseCryptoLine);\n};\n\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  const ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-ufrag:')[0];\n  const pwd = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=ice-pwd:')[0];\n  if (!(ufrag && pwd)) {\n    return null;\n  }\n  return {\n    usernameFragment: ufrag.substring(12),\n    password: pwd.substring(10),\n  };\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  let sdp = 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n  if (params.iceLite) {\n    sdp += 'a=ice-lite\\r\\n';\n  }\n  return sdp;\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  const description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: [],\n  };\n  const lines = SDPUtils.splitLines(mediaSection);\n  const mline = lines[0].split(' ');\n  description.profile = mline[2];\n  for (let i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    const pt = mline[i];\n    const rtpmapline = SDPUtils.matchPrefix(\n      mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      const codec = SDPUtils.parseRtpMap(rtpmapline);\n      const fmtps = SDPUtils.matchPrefix(\n        mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(line => {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  const wildcardRtcpFb = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-fb:* ')\n    .map(SDPUtils.parseRtcpFb);\n  description.codecs.forEach(codec => {\n    wildcardRtcpFb.forEach(fb=> {\n      const duplicate = codec.rtcpFeedback.find(existingFeedback => {\n        return existingFeedback.type === fb.type &&\n          existingFeedback.parameter === fb.parameter;\n      });\n      if (!duplicate) {\n        codec.rtcpFeedback.push(fb);\n      }\n    });\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  let sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' ' + (caps.profile || 'UDP/TLS/RTP/SAVPF') + ' ';\n  sdp += caps.codecs.map(codec => {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(codec => {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  let maxptime = 0;\n  caps.codecs.forEach(codec => {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(extension => {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  const encodingParameters = [];\n  const description = SDPUtils.parseRtpParameters(mediaSection);\n  const hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  const hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  const ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(parts => parts.attribute === 'cname');\n  const primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  let secondarySsrc;\n\n  const flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n    .map(line => {\n      const parts = line.substring(17).split(' ');\n      return parts.map(part => parseInt(part, 10));\n    });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(codec => {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      let encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10),\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red',\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc,\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  let bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substring(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substring(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(params => {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  const rtcpParameters = {};\n\n  // Gets the first SSRC. Note that with RTX there might be multiple\n  // SSRCs.\n  const remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(obj => obj.attribute === 'cname')[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  const rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrbute.\n  // Note that Edge does not support unmuxed RTCP.\n  const mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\nSDPUtils.writeRtcpParameters = function(rtcpParameters) {\n  let sdp = '';\n  if (rtcpParameters.reducedSize) {\n    sdp += 'a=rtcp-rsize\\r\\n';\n  }\n  if (rtcpParameters.mux) {\n    sdp += 'a=rtcp-mux\\r\\n';\n  }\n  if (rtcpParameters.ssrc !== undefined && rtcpParameters.cname) {\n    sdp += 'a=ssrc:' + rtcpParameters.ssrc +\n      ' cname:' + rtcpParameters.cname + '\\r\\n';\n  }\n  return sdp;\n};\n\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  let parts;\n  const spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substring(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  const planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(line => SDPUtils.parseSsrcMedia(line))\n    .filter(msidParts => msidParts.attribute === 'msid');\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// SCTP\n// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n// to draft-ietf-mmusic-sctp-sdp-05\nSDPUtils.parseSctpDescription = function(mediaSection) {\n  const mline = SDPUtils.parseMLine(mediaSection);\n  const maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n  let maxMessageSize;\n  if (maxSizeLine.length > 0) {\n    maxMessageSize = parseInt(maxSizeLine[0].substring(19), 10);\n  }\n  if (isNaN(maxMessageSize)) {\n    maxMessageSize = 65536;\n  }\n  const sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n  if (sctpPort.length > 0) {\n    return {\n      port: parseInt(sctpPort[0].substring(12), 10),\n      protocol: mline.fmt,\n      maxMessageSize,\n    };\n  }\n  const sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n  if (sctpMapLines.length > 0) {\n    const parts = sctpMapLines[0]\n      .substring(10)\n      .split(' ');\n    return {\n      port: parseInt(parts[0], 10),\n      protocol: parts[1],\n      maxMessageSize,\n    };\n  }\n};\n\n// SCTP\n// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n// support by now receiving in this format, unless we originally parsed\n// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n// protocol of DTLS/SCTP -- without UDP/ or TCP/)\nSDPUtils.writeSctpDescription = function(media, sctp) {\n  let output = [];\n  if (media.protocol !== 'DTLS/SCTP') {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctp-port:' + sctp.port + '\\r\\n',\n    ];\n  } else {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n',\n    ];\n  }\n  if (sctp.maxMessageSize !== undefined) {\n    output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n  }\n  return output.join('');\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 22);\n};\n\n// Write boiler plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  let sessionId;\n  const version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  const user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  const lines = SDPUtils.splitLines(mediaSection);\n  for (let i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substring(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  const lines = SDPUtils.splitLines(mediaSection);\n  const mline = lines[0].split(' ');\n  return mline[0].substring(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  const lines = SDPUtils.splitLines(mediaSection);\n  const parts = lines[0].substring(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' '),\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  const line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  const parts = line.substring(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5],\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  const lines = SDPUtils.splitLines(blob);\n  for (let i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods (patched for ESM)\nexport default SDPUtils;\nexport { SDPUtils };\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport SDPUtils from 'sdp';\nimport * as utils from './utils';\n\nexport function shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  const NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function RTCIceCandidate(args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if (typeof args === 'object' && args.candidate &&\n        args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substring(2);\n    }\n\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      const nativeCandidate = new NativeRTCIceCandidate(args);\n      const parsedCandidate = SDPUtils.parseCandidate(args.candidate);\n      for (const key in parsedCandidate) {\n        if (!(key in nativeCandidate)) {\n          Object.defineProperty(nativeCandidate, key,\n            {value: parsedCandidate[key]});\n        }\n      }\n\n      // Override serializer to not serialize the extra attributes.\n      nativeCandidate.toJSON = function toJSON() {\n        return {\n          candidate: nativeCandidate.candidate,\n          sdpMid: nativeCandidate.sdpMid,\n          sdpMLineIndex: nativeCandidate.sdpMLineIndex,\n          usernameFragment: nativeCandidate.usernameFragment,\n        };\n      };\n      return nativeCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\n\nexport function shimRTCIceCandidateRelayProtocol(window) {\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'relayProtocol' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      const parsedCandidate = SDPUtils.parseCandidate(e.candidate.candidate);\n      if (parsedCandidate.type === 'relay') {\n        // This is a libwebrtc-specific mapping of local type preference\n        // to relayProtocol.\n        e.candidate.relayProtocol = {\n          0: 'tls',\n          1: 'tcp',\n          2: 'udp',\n        }[parsedCandidate.priority >> 24];\n      }\n    }\n    return e;\n  });\n}\n\nexport function shimMaxMessageSize(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n\n  const sctpInDescription = function(description) {\n    if (!description || !description.sdp) {\n      return false;\n    }\n    const sections = SDPUtils.splitSections(description.sdp);\n    sections.shift();\n    return sections.some(mediaSection => {\n      const mLine = SDPUtils.parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application'\n          && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n\n  const getRemoteFirefoxVersion = function(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    const match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    const version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n\n  const getCanSendMaxMessageSize = function(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    let canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize =\n          browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n\n  const getMaxMessageSize = function(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    let maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox'\n         && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n\n    const match = SDPUtils.matchPrefix(description.sdp,\n      'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substring(19), 10);\n    } else if (browserDetails.browser === 'firefox' &&\n                remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n\n  const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n    function setRemoteDescription() {\n      this._sctp = null;\n      // Chrome decided to not expose .sctp in plan-b mode.\n      // As usual, adapter.js has to do an 'ugly worakaround'\n      // to cover up the mess.\n      if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n        const {sdpSemantics} = this.getConfiguration();\n        if (sdpSemantics === 'plan-b') {\n          Object.defineProperty(this, 'sctp', {\n            get() {\n              return typeof this._sctp === 'undefined' ? null : this._sctp;\n            },\n            enumerable: true,\n            configurable: true,\n          });\n        }\n      }\n\n      if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n        const isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n        // Get the maximum message size the local peer is capable of sending\n        const canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n        // Get the maximum message size of the remote peer.\n        const remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n        // Determine final maximum message size\n        let maxMessageSize;\n        if (canSendMMS === 0 && remoteMMS === 0) {\n          maxMessageSize = Number.POSITIVE_INFINITY;\n        } else if (canSendMMS === 0 || remoteMMS === 0) {\n          maxMessageSize = Math.max(canSendMMS, remoteMMS);\n        } else {\n          maxMessageSize = Math.min(canSendMMS, remoteMMS);\n        }\n\n        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n        // attribute.\n        const sctp = {};\n        Object.defineProperty(sctp, 'maxMessageSize', {\n          get() {\n            return maxMessageSize;\n          }\n        });\n        this._sctp = sctp;\n      }\n\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n}\n\nexport function shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection &&\n      'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    const origDataChannelSend = dc.send;\n    dc.send = function send() {\n      const data = arguments[0];\n      const length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' &&\n          pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' +\n          pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  const origCreateDataChannel =\n    window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel =\n    function createDataChannel() {\n      const dataChannel = origCreateDataChannel.apply(this, arguments);\n      wrapDcSend(dataChannel, this);\n      return dataChannel;\n    };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', e => {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nexport function shimConnectionState(window) {\n  if (!window.RTCPeerConnection ||\n      'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get() {\n      return this._onconnectionstatechange || null;\n    },\n    set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange',\n          this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange',\n          this._onconnectionstatechange = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ['setLocalDescription', 'setRemoteDescription'].forEach((method) => {\n    const origMethod = proto[method];\n    proto[method] = function() {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = e => {\n          const pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            const newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange',\n          this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\n\nexport function removeExtmapAllowMixed(window, browserDetails) {\n  /* remove a=extmap-allow-mixed for webrtc.org < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  if (browserDetails.browser === 'safari' && browserDetails.version >= 605) {\n    return;\n  }\n  const nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n  function setRemoteDescription(desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      const sdp = desc.sdp.split('\\n').filter((line) => {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n      // Safari enforces read-only-ness of RTCSessionDescription fields.\n      if (window.RTCSessionDescription &&\n          desc instanceof window.RTCSessionDescription) {\n        arguments[0] = new window.RTCSessionDescription({\n          type: desc.type,\n          sdp,\n        });\n      } else {\n        desc.sdp = sdp;\n      }\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\n\nexport function shimAddIceCandidateNullOrEmpty(window, browserDetails) {\n  // Support for addIceCandidate(null or undefined)\n  // as well as addIceCandidate({candidate: \"\", ...})\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=978582\n  // Note: must be called before other polyfills which change the signature.\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeAddIceCandidate =\n      window.RTCPeerConnection.prototype.addIceCandidate;\n  if (!nativeAddIceCandidate) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.addIceCandidate =\n    function addIceCandidate() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n      // in older versions.\n      // Native support for ignoring exists for Chrome M77+.\n      // Safari ignores as well, exact version unknown but works in the same\n      // version that also ignores addIceCandidate(null).\n      if (((browserDetails.browser === 'chrome' && browserDetails.version < 78)\n           || (browserDetails.browser === 'firefox'\n               && browserDetails.version < 68)\n           || (browserDetails.browser === 'safari'))\n          && arguments[0] && arguments[0].candidate === '') {\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n}\n\n// Note: Make sure to call this ahead of APIs that modify\n// setLocalDescription.length\nexport function shimParameterlessSetLocalDescription(window, browserDetails) {\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  if (!nativeSetLocalDescription || nativeSetLocalDescription.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      let desc = arguments[0] || {};\n      if (typeof desc !== 'object' || (desc.type && desc.sdp)) {\n        return nativeSetLocalDescription.apply(this, arguments);\n      }\n      // The remaining steps should technically happen when SLD comes off the\n      // RTCPeerConnection's operations chain (not ahead of going on it), but\n      // this is too difficult to shim. Instead, this shim only covers the\n      // common case where the operations chain is empty. This is imperfect, but\n      // should cover many cases. Rationale: Even if we can't reduce the glare\n      // window to zero on imperfect implementations, there's value in tapping\n      // into the perfect negotiation pattern that several browsers support.\n      desc = {type: desc.type, sdp: desc.sdp};\n      if (!desc.type) {\n        switch (this.signalingState) {\n          case 'stable':\n          case 'have-local-offer':\n          case 'have-remote-pranswer':\n            desc.type = 'offer';\n            break;\n          default:\n            desc.type = 'answer';\n            break;\n        }\n      }\n      if (desc.sdp || (desc.type !== 'offer' && desc.type !== 'answer')) {\n        return nativeSetLocalDescription.apply(this, [desc]);\n      }\n      const func = desc.type === 'offer' ? this.createOffer : this.createAnswer;\n      return func.apply(this)\n        .then(d => nativeSetLocalDescription.apply(this, [d]));\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\nimport * as utils from './utils';\n\n// Browser shims.\nimport * as chromeShim from './chrome/chrome_shim';\nimport * as firefoxShim from './firefox/firefox_shim';\nimport * as safariShim from './safari/safari_shim';\nimport * as commonShim from './common_shim';\nimport * as sdp from 'sdp';\n\n// Shimming starts here.\nexport function adapterFactory({window} = {}, options = {\n  shimChrome: true,\n  shimFirefox: true,\n  shimSafari: true,\n}) {\n  // Utils.\n  const logging = utils.log;\n  const browserDetails = utils.detectBrowser(window);\n\n  const adapter = {\n    browserDetails,\n    commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings,\n    // Expose sdp as a convenience. For production apps include directly.\n    sdp,\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\n          !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      if (browserDetails.version === null) {\n        logging('Chrome shim can not determine version, not shimming.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      chromeShim.shimGetUserMedia(window, browserDetails);\n      chromeShim.shimMediaStream(window, browserDetails);\n      chromeShim.shimPeerConnection(window, browserDetails);\n      chromeShim.shimOnTrack(window, browserDetails);\n      chromeShim.shimAddTrackRemoveTrack(window, browserDetails);\n      chromeShim.shimGetSendersWithDtmf(window, browserDetails);\n      chromeShim.shimGetStats(window, browserDetails);\n      chromeShim.shimSenderReceiverGetStats(window, browserDetails);\n      chromeShim.fixNegotiationNeeded(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimRTCIceCandidateRelayProtocol(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\n          !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      firefoxShim.shimGetUserMedia(window, browserDetails);\n      firefoxShim.shimPeerConnection(window, browserDetails);\n      firefoxShim.shimOnTrack(window, browserDetails);\n      firefoxShim.shimRemoveStream(window, browserDetails);\n      firefoxShim.shimSenderGetStats(window, browserDetails);\n      firefoxShim.shimReceiverGetStats(window, browserDetails);\n      firefoxShim.shimRTCDataChannel(window, browserDetails);\n      firefoxShim.shimAddTransceiver(window, browserDetails);\n      firefoxShim.shimGetParameters(window, browserDetails);\n      firefoxShim.shimCreateOffer(window, browserDetails);\n      firefoxShim.shimCreateAnswer(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      // Must be called before shimCallbackAPI.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n      commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n      safariShim.shimRTCIceServerUrls(window, browserDetails);\n      safariShim.shimCreateOfferLegacy(window, browserDetails);\n      safariShim.shimCallbacksAPI(window, browserDetails);\n      safariShim.shimLocalStreamsAPI(window, browserDetails);\n      safariShim.shimRemoteStreamsAPI(window, browserDetails);\n      safariShim.shimTrackEventTransceiver(window, browserDetails);\n      safariShim.shimGetUserMedia(window, browserDetails);\n      safariShim.shimAudioContext(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimRTCIceCandidateRelayProtocol(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nimport {adapterFactory} from './adapter_factory.js';\n\nconst adapter =\n  adapterFactory({window: typeof window === 'undefined' ? undefined : window});\nexport default adapter;\n","/*\n * gstwebrtc-api\n *\n * Copyright (C) 2022 Igalia S.L. <info@igalia.com>\n *   Author: Loc Le Page <llepage@igalia.com>\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\n/**\n * GStreamer WebRTC configuration.\n * <p>The config can be passed on creation of the GstWebRTCAPI class.</p>\n * <p>For example:\n * <pre>\n *     const signalingProtocol = window.location.protocol.startsWith(\"https\") ? \"wss\" : \"ws\";\n *     const api = new GstWebRTCAPI({\n *         meta: { name: `WebClient-${Date.now()}` },\n *         signalingServerUrl: `${signalingProtocol}://${window.location.host}/webrtc`\n *     });\n * </pre></p>\n * @typedef {object} GstWebRTCConfig\n * @property {object} meta=null - Client free-form information that will be exchanged with all peers through the\n * signaling <i>meta</i> property, its content depends on your application.\n * @property {string} signalingServerUrl=ws://127.0.0.1:8443 - The WebRTC signaling server URL.\n * @property {number} reconnectionTimeout=2500 - Timeout in milliseconds to reconnect to the signaling server in\n * case of an unexpected disconnection.\n * @property {object} webrtcConfig={iceServers...} - The WebRTC peer connection configuration passed to\n * {@link RTCPeerConnection}. Default configuration only includes a list of free STUN servers\n * (<i>stun[0-4].l.google.com:19302</i>).\n */\n\n/**\n * Default GstWebRTCAPI configuration.\n * @type {GstWebRTCConfig}\n */\nconst defaultConfig = Object.freeze({\n  meta: null,\n  signalingServerUrl: \"ws://127.0.0.1:8443\",\n  reconnectionTimeout: 2500,\n  webrtcConfig: {\n    iceServers: [\n      {\n        urls: [\n          \"stun:stun.l.google.com:19302\",\n          \"stun:stun1.l.google.com:19302\"\n        ]\n      }\n    ],\n    bundlePolicy: \"max-bundle\"\n  }\n});\n\nexport default defaultConfig;\n","/*\n * gstwebrtc-api\n *\n * Copyright (C) 2022 Igalia S.L. <info@igalia.com>\n *   Author: Loc Le Page <llepage@igalia.com>\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\n/**\n * Session states enumeration.<br>\n * Session state always increases from idle to closed and never switches backwards.\n * @enum {number}\n * @readonly\n */\nconst SessionState = /** @type {const} */ {\n  /**\n   * (0) Default state when creating a new session, goes to <i>connecting</i> when starting the session.\n   */\n  idle: 0,\n  /**\n   * (1) Session is trying to connect to remote peers, goes to <i>streaming</i> in case of\n   * success or <i>closed</i> in case of error.\n   */\n  connecting: 1,\n  /**\n   * (2) Session is correctly connected to remote peers and currently streaming audio/video, goes\n   * to <i>closed</i> when any peer closes the session.\n   */\n  streaming: 2,\n  /**\n   * (3) Session is closed and can be garbage collected, state will not change anymore.\n   */\n  closed: 3\n};\nObject.freeze(SessionState);\n\nexport default SessionState;\n","/*\n * gstwebrtc-api\n *\n * Copyright (C) 2022 Igalia S.L. <info@igalia.com>\n *   Author: Loc Le Page <llepage@igalia.com>\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\nimport SessionState from \"./session-state.js\";\n\n/** @import ProducerSession from \"./producer-session.js\"; */\n/** @import ClientSession from \"./producer-session.js\"; */\n\n/**\n * Event name: \"error\".<br>\n * Triggered when any kind of error occurs.\n * <p>When emitted by a session, it is in general an unrecoverable error. Normally, the session is automatically closed\n * but in the specific case of a {@link ProducerSession}, when the error occurs on an underlying\n * {@link ClientSession} between the producer session and a remote client consuming the streamed media,\n * then only the failing {@link ClientSession} is closed. The producer session can keep on serving the\n * other consumer peers.</p>\n * @event GstWebRTCAPI#ErrorEvent\n * @type {ErrorEvent}\n * @property {string} message - The error message.\n * @property {Error} error - The error exception.\n * @see WebRTCSession\n * @see RemoteController\n */\n/**\n * Event name: \"stateChanged\".<br>\n * Triggered each time a session state changes.\n * @event GstWebRTCAPI#StateChangedEvent\n * @type {Event}\n * @see WebRTCSession#state\n */\n/**\n * Event name: \"rtcPeerConnectionChanged\".<br>\n * Triggered each time a session internal {@link RTCPeerConnection} changes. This can occur during the session\n * connecting state when the peer-to-peer WebRTC connection is established, and when closing the\n * {@link WebRTCSession}.\n * @event GstWebRTCAPI#RTCPeerConnectionChangedEvent\n * @type {Event}\n * @see WebRTCSession#rtcPeerConnection\n */\n/**\n * Event name: \"closed\".<br>\n * Triggered when a session is definitively closed (then it can be garbage collected as session instances are not\n * reusable).\n * @event GstWebRTCAPI#ClosedEvent\n * @type {Event}\n */\n\n/**\n * @class WebRTCSession\n * @hideconstructor\n * @classdesc Manages a WebRTC session between a producer and a consumer (peer-to-peer channel).\n * @extends {EventTarget}\n * @fires {@link GstWebRTCAPI#event:ErrorEvent}\n * @fires {@link GstWebRTCAPI#event:StateChangedEvent}\n * @fires {@link GstWebRTCAPI#event:RTCPeerConnectionChangedEvent}\n * @fires {@link GstWebRTCAPI#event:ClosedEvent}\n * @see ConsumerSession\n * @see ProducerSession\n * @see ClientSession\n */\nclass WebRTCSession extends EventTarget {\n  constructor(peerId, comChannel) {\n    super();\n\n    this._peerId = peerId;\n    this._sessionId = \"\";\n    this._comChannel = comChannel;\n    this._state = SessionState.idle;\n    this._rtcPeerConnection = null;\n  }\n\n  /**\n   * Unique identifier of the remote peer to which this session is connected.\n   * @type {string}\n   * @readonly\n   */\n  get peerId() {\n    return this._peerId;\n  }\n\n  /**\n   * Unique identifier of this session (defined by the signaling server).<br>\n   * The local session ID equals \"\" until it is created on server side. This is done during the connection handshake.\n   * The local session ID is guaranteed to be valid and to correctly reflect the signaling server value once\n   * session state has switched to {@link SessionState#streaming}.\n   * @type {string}\n   * @readonly\n   */\n  get sessionId() {\n    return this._sessionId;\n  }\n\n  /**\n   * The current WebRTC session state.\n   * @type {SessionState}\n   * @readonly\n   */\n  get state() {\n    return this._state;\n  }\n\n  /**\n   * The internal {@link RTCPeerConnection} used to manage the underlying WebRTC connection with session\n   * peer. Value may be null if session has no active WebRTC connection. You can listen to the\n   * {@link GstWebRTCAPI#event:RTCPeerConnectionChangedEvent} event to be informed when the connection is established\n   * or destroyed.\n   * @type {RTCPeerConnection}\n   * @readonly\n   */\n  get rtcPeerConnection() {\n    return this._rtcPeerConnection;\n  }\n\n  /**\n   * Terminates the WebRTC session.<br>\n   * It immediately disconnects the remote peer attached to this session and unregisters the session from the\n   * signaling server.\n   */\n  close() {\n    if (this._state !== SessionState.closed) {\n      if ((this._state !== SessionState.idle) && this._comChannel && this._sessionId) {\n        this._comChannel.send({\n          type: \"endSession\",\n          sessionId: this._sessionId\n        });\n      }\n\n      this._state = SessionState.closed;\n      this.dispatchEvent(new Event(\"stateChanged\"));\n\n      this._comChannel = null;\n\n      if (this._rtcPeerConnection) {\n        this._rtcPeerConnection.close();\n        this._rtcPeerConnection = null;\n        this.dispatchEvent(new Event(\"rtcPeerConnectionChanged\"));\n      }\n\n      this.dispatchEvent(new Event(\"closed\"));\n    }\n  }\n}\n\nexport default WebRTCSession;\n","/*\n * gstwebrtc-api\n *\n * Copyright (C) 2022 Igalia S.L. <info@igalia.com>\n *   Author: Loc Le Page <llepage@igalia.com>\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\n// mapping is based on https://www.cl.cam.ac.uk/~mgk25/ucs/keysyms.txt\nconst uniToKeySyms = Object.freeze({\n  0x0020: \"space\",\n  0x0021: \"exclam\",\n  0x0022: \"quotedbl\",\n  0x0023: \"numbersign\",\n  0x0024: \"dollar\",\n  0x0025: \"percent\",\n  0x0026: \"ampersand\",\n  0x0027: \"apostrophe\",\n  0x0028: \"parenleft\",\n  0x0029: \"parenright\",\n  0x002a: \"asterisk\",\n  0x002b: \"plus\",\n  0x002c: \"comma\",\n  0x002d: \"minus\",\n  0x002e: \"period\",\n  0x002f: \"slash\",\n  0x0030: \"0\",\n  0x0031: \"1\",\n  0x0032: \"2\",\n  0x0033: \"3\",\n  0x0034: \"4\",\n  0x0035: \"5\",\n  0x0036: \"6\",\n  0x0037: \"7\",\n  0x0038: \"8\",\n  0x0039: \"9\",\n  0x003a: \"colon\",\n  0x003b: \"semicolon\",\n  0x003c: \"less\",\n  0x003d: \"equal\",\n  0x003e: \"greater\",\n  0x003f: \"question\",\n  0x0040: \"at\",\n  0x0041: \"A\",\n  0x0042: \"B\",\n  0x0043: \"C\",\n  0x0044: \"D\",\n  0x0045: \"E\",\n  0x0046: \"F\",\n  0x0047: \"G\",\n  0x0048: \"H\",\n  0x0049: \"I\",\n  0x004a: \"J\",\n  0x004b: \"K\",\n  0x004c: \"L\",\n  0x004d: \"M\",\n  0x004e: \"N\",\n  0x004f: \"O\",\n  0x0050: \"P\",\n  0x0051: \"Q\",\n  0x0052: \"R\",\n  0x0053: \"S\",\n  0x0054: \"T\",\n  0x0055: \"U\",\n  0x0056: \"V\",\n  0x0057: \"W\",\n  0x0058: \"X\",\n  0x0059: \"Y\",\n  0x005a: \"Z\",\n  0x005b: \"bracketleft\",\n  0x005c: \"backslash\",\n  0x005d: \"bracketright\",\n  0x005e: \"asciicircum\",\n  0x005f: \"underscore\",\n  0x0060: \"grave\",\n  0x0061: \"a\",\n  0x0062: \"b\",\n  0x0063: \"c\",\n  0x0064: \"d\",\n  0x0065: \"e\",\n  0x0066: \"f\",\n  0x0067: \"g\",\n  0x0068: \"h\",\n  0x0069: \"i\",\n  0x006a: \"j\",\n  0x006b: \"k\",\n  0x006c: \"l\",\n  0x006d: \"m\",\n  0x006e: \"n\",\n  0x006f: \"o\",\n  0x0070: \"p\",\n  0x0071: \"q\",\n  0x0072: \"r\",\n  0x0073: \"s\",\n  0x0074: \"t\",\n  0x0075: \"u\",\n  0x0076: \"v\",\n  0x0077: \"w\",\n  0x0078: \"x\",\n  0x0079: \"y\",\n  0x007a: \"z\",\n  0x007b: \"braceleft\",\n  0x007c: \"bar\",\n  0x007d: \"braceright\",\n  0x007e: \"asciitilde\",\n  0x00a0: \"nobreakspace\",\n  0x00a1: \"exclamdown\",\n  0x00a2: \"cent\",\n  0x00a3: \"sterling\",\n  0x00a4: \"currency\",\n  0x00a5: \"yen\",\n  0x00a6: \"brokenbar\",\n  0x00a7: \"section\",\n  0x00a8: \"diaeresis\",\n  0x00a9: \"copyright\",\n  0x00aa: \"ordfeminine\",\n  0x00ab: \"guillemotleft\",\n  0x00ac: \"notsign\",\n  0x00ad: \"hyphen\",\n  0x00ae: \"registered\",\n  0x00af: \"macron\",\n  0x00b0: \"degree\",\n  0x00b1: \"plusminus\",\n  0x00b2: \"twosuperior\",\n  0x00b3: \"threesuperior\",\n  0x00b4: \"acute\",\n  0x00b5: \"mu\",\n  0x00b6: \"paragraph\",\n  0x00b7: \"periodcentered\",\n  0x00b8: \"cedilla\",\n  0x00b9: \"onesuperior\",\n  0x00ba: \"masculine\",\n  0x00bb: \"guillemotright\",\n  0x00bc: \"onequarter\",\n  0x00bd: \"onehalf\",\n  0x00be: \"threequarters\",\n  0x00bf: \"questiondown\",\n  0x00c0: \"Agrave\",\n  0x00c1: \"Aacute\",\n  0x00c2: \"Acircumflex\",\n  0x00c3: \"Atilde\",\n  0x00c4: \"Adiaeresis\",\n  0x00c5: \"Aring\",\n  0x00c6: \"AE\",\n  0x00c7: \"Ccedilla\",\n  0x00c8: \"Egrave\",\n  0x00c9: \"Eacute\",\n  0x00ca: \"Ecircumflex\",\n  0x00cb: \"Ediaeresis\",\n  0x00cc: \"Igrave\",\n  0x00cd: \"Iacute\",\n  0x00ce: \"Icircumflex\",\n  0x00cf: \"Idiaeresis\",\n  0x00d0: \"ETH\",\n  0x00d1: \"Ntilde\",\n  0x00d2: \"Ograve\",\n  0x00d3: \"Oacute\",\n  0x00d4: \"Ocircumflex\",\n  0x00d5: \"Otilde\",\n  0x00d6: \"Odiaeresis\",\n  0x00d7: \"multiply\",\n  0x00d8: \"Ooblique\",\n  0x00d9: \"Ugrave\",\n  0x00da: \"Uacute\",\n  0x00db: \"Ucircumflex\",\n  0x00dc: \"Udiaeresis\",\n  0x00dd: \"Yacute\",\n  0x00de: \"THORN\",\n  0x00df: \"ssharp\",\n  0x00e0: \"agrave\",\n  0x00e1: \"aacute\",\n  0x00e2: \"acircumflex\",\n  0x00e3: \"atilde\",\n  0x00e4: \"adiaeresis\",\n  0x00e5: \"aring\",\n  0x00e6: \"ae\",\n  0x00e7: \"ccedilla\",\n  0x00e8: \"egrave\",\n  0x00e9: \"eacute\",\n  0x00ea: \"ecircumflex\",\n  0x00eb: \"ediaeresis\",\n  0x00ec: \"igrave\",\n  0x00ed: \"iacute\",\n  0x00ee: \"icircumflex\",\n  0x00ef: \"idiaeresis\",\n  0x00f0: \"eth\",\n  0x00f1: \"ntilde\",\n  0x00f2: \"ograve\",\n  0x00f3: \"oacute\",\n  0x00f4: \"ocircumflex\",\n  0x00f5: \"otilde\",\n  0x00f6: \"odiaeresis\",\n  0x00f7: \"division\",\n  0x00f8: \"oslash\",\n  0x00f9: \"ugrave\",\n  0x00fa: \"uacute\",\n  0x00fb: \"ucircumflex\",\n  0x00fc: \"udiaeresis\",\n  0x00fd: \"yacute\",\n  0x00fe: \"thorn\",\n  0x00ff: \"ydiaeresis\",\n  0x0104: \"Aogonek\",\n  0x02d8: \"breve\",\n  0x0141: \"Lstroke\",\n  0x013d: \"Lcaron\",\n  0x015a: \"Sacute\",\n  0x0160: \"Scaron\",\n  0x015e: \"Scedilla\",\n  0x0164: \"Tcaron\",\n  0x0179: \"Zacute\",\n  0x017d: \"Zcaron\",\n  0x017b: \"Zabovedot\",\n  0x0105: \"aogonek\",\n  0x02db: \"ogonek\",\n  0x0142: \"lstroke\",\n  0x013e: \"lcaron\",\n  0x015b: \"sacute\",\n  0x02c7: \"caron\",\n  0x0161: \"scaron\",\n  0x015f: \"scedilla\",\n  0x0165: \"tcaron\",\n  0x017a: \"zacute\",\n  0x02dd: \"doubleacute\",\n  0x017e: \"zcaron\",\n  0x017c: \"zabovedot\",\n  0x0154: \"Racute\",\n  0x0102: \"Abreve\",\n  0x0139: \"Lacute\",\n  0x0106: \"Cacute\",\n  0x010c: \"Ccaron\",\n  0x0118: \"Eogonek\",\n  0x011a: \"Ecaron\",\n  0x010e: \"Dcaron\",\n  0x0110: \"Dstroke\",\n  0x0143: \"Nacute\",\n  0x0147: \"Ncaron\",\n  0x0150: \"Odoubleacute\",\n  0x0158: \"Rcaron\",\n  0x016e: \"Uring\",\n  0x0170: \"Udoubleacute\",\n  0x0162: \"Tcedilla\",\n  0x0155: \"racute\",\n  0x0103: \"abreve\",\n  0x013a: \"lacute\",\n  0x0107: \"cacute\",\n  0x010d: \"ccaron\",\n  0x0119: \"eogonek\",\n  0x011b: \"ecaron\",\n  0x010f: \"dcaron\",\n  0x0111: \"dstroke\",\n  0x0144: \"nacute\",\n  0x0148: \"ncaron\",\n  0x0151: \"odoubleacute\",\n  0x0159: \"rcaron\",\n  0x016f: \"uring\",\n  0x0171: \"udoubleacute\",\n  0x0163: \"tcedilla\",\n  0x02d9: \"abovedot\",\n  0x0126: \"Hstroke\",\n  0x0124: \"Hcircumflex\",\n  0x0130: \"Iabovedot\",\n  0x011e: \"Gbreve\",\n  0x0134: \"Jcircumflex\",\n  0x0127: \"hstroke\",\n  0x0125: \"hcircumflex\",\n  0x0131: \"idotless\",\n  0x011f: \"gbreve\",\n  0x0135: \"jcircumflex\",\n  0x010a: \"Cabovedot\",\n  0x0108: \"Ccircumflex\",\n  0x0120: \"Gabovedot\",\n  0x011c: \"Gcircumflex\",\n  0x016c: \"Ubreve\",\n  0x015c: \"Scircumflex\",\n  0x010b: \"cabovedot\",\n  0x0109: \"ccircumflex\",\n  0x0121: \"gabovedot\",\n  0x011d: \"gcircumflex\",\n  0x016d: \"ubreve\",\n  0x015d: \"scircumflex\",\n  0x0138: \"kra\",\n  0x0156: \"Rcedilla\",\n  0x0128: \"Itilde\",\n  0x013b: \"Lcedilla\",\n  0x0112: \"Emacron\",\n  0x0122: \"Gcedilla\",\n  0x0166: \"Tslash\",\n  0x0157: \"rcedilla\",\n  0x0129: \"itilde\",\n  0x013c: \"lcedilla\",\n  0x0113: \"emacron\",\n  0x0123: \"gcedilla\",\n  0x0167: \"tslash\",\n  0x014a: \"ENG\",\n  0x014b: \"eng\",\n  0x0100: \"Amacron\",\n  0x012e: \"Iogonek\",\n  0x0116: \"Eabovedot\",\n  0x012a: \"Imacron\",\n  0x0145: \"Ncedilla\",\n  0x014c: \"Omacron\",\n  0x0136: \"Kcedilla\",\n  0x0172: \"Uogonek\",\n  0x0168: \"Utilde\",\n  0x016a: \"Umacron\",\n  0x0101: \"amacron\",\n  0x012f: \"iogonek\",\n  0x0117: \"eabovedot\",\n  0x012b: \"imacron\",\n  0x0146: \"ncedilla\",\n  0x014d: \"omacron\",\n  0x0137: \"kcedilla\",\n  0x0173: \"uogonek\",\n  0x0169: \"utilde\",\n  0x016b: \"umacron\",\n  0x203e: \"overline\",\n  0x3002: \"kana_fullstop\",\n  0x300c: \"kana_openingbracket\",\n  0x300d: \"kana_closingbracket\",\n  0x3001: \"kana_comma\",\n  0x30fb: \"kana_conjunctive\",\n  0x30f2: \"kana_WO\",\n  0x30a1: \"kana_a\",\n  0x30a3: \"kana_i\",\n  0x30a5: \"kana_u\",\n  0x30a7: \"kana_e\",\n  0x30a9: \"kana_o\",\n  0x30e3: \"kana_ya\",\n  0x30e5: \"kana_yu\",\n  0x30e7: \"kana_yo\",\n  0x30c3: \"kana_tsu\",\n  0x30fc: \"prolongedsound\",\n  0x30a2: \"kana_A\",\n  0x30a4: \"kana_I\",\n  0x30a6: \"kana_U\",\n  0x30a8: \"kana_E\",\n  0x30aa: \"kana_O\",\n  0x30ab: \"kana_KA\",\n  0x30ad: \"kana_KI\",\n  0x30af: \"kana_KU\",\n  0x30b1: \"kana_KE\",\n  0x30b3: \"kana_KO\",\n  0x30b5: \"kana_SA\",\n  0x30b7: \"kana_SHI\",\n  0x30b9: \"kana_SU\",\n  0x30bb: \"kana_SE\",\n  0x30bd: \"kana_SO\",\n  0x30bf: \"kana_TA\",\n  0x30c1: \"kana_CHI\",\n  0x30c4: \"kana_TSU\",\n  0x30c6: \"kana_TE\",\n  0x30c8: \"kana_TO\",\n  0x30ca: \"kana_NA\",\n  0x30cb: \"kana_NI\",\n  0x30cc: \"kana_NU\",\n  0x30cd: \"kana_NE\",\n  0x30ce: \"kana_NO\",\n  0x30cf: \"kana_HA\",\n  0x30d2: \"kana_HI\",\n  0x30d5: \"kana_FU\",\n  0x30d8: \"kana_HE\",\n  0x30db: \"kana_HO\",\n  0x30de: \"kana_MA\",\n  0x30df: \"kana_MI\",\n  0x30e0: \"kana_MU\",\n  0x30e1: \"kana_ME\",\n  0x30e2: \"kana_MO\",\n  0x30e4: \"kana_YA\",\n  0x30e6: \"kana_YU\",\n  0x30e8: \"kana_YO\",\n  0x30e9: \"kana_RA\",\n  0x30ea: \"kana_RI\",\n  0x30eb: \"kana_RU\",\n  0x30ec: \"kana_RE\",\n  0x30ed: \"kana_RO\",\n  0x30ef: \"kana_WA\",\n  0x30f3: \"kana_N\",\n  0x309b: \"voicedsound\",\n  0x309c: \"semivoicedsound\",\n  0x060c: \"Arabic_comma\",\n  0x061b: \"Arabic_semicolon\",\n  0x061f: \"Arabic_question_mark\",\n  0x0621: \"Arabic_hamza\",\n  0x0622: \"Arabic_maddaonalef\",\n  0x0623: \"Arabic_hamzaonalef\",\n  0x0624: \"Arabic_hamzaonwaw\",\n  0x0625: \"Arabic_hamzaunderalef\",\n  0x0626: \"Arabic_hamzaonyeh\",\n  0x0627: \"Arabic_alef\",\n  0x0628: \"Arabic_beh\",\n  0x0629: \"Arabic_tehmarbuta\",\n  0x062a: \"Arabic_teh\",\n  0x062b: \"Arabic_theh\",\n  0x062c: \"Arabic_jeem\",\n  0x062d: \"Arabic_hah\",\n  0x062e: \"Arabic_khah\",\n  0x062f: \"Arabic_dal\",\n  0x0630: \"Arabic_thal\",\n  0x0631: \"Arabic_ra\",\n  0x0632: \"Arabic_zain\",\n  0x0633: \"Arabic_seen\",\n  0x0634: \"Arabic_sheen\",\n  0x0635: \"Arabic_sad\",\n  0x0636: \"Arabic_dad\",\n  0x0637: \"Arabic_tah\",\n  0x0638: \"Arabic_zah\",\n  0x0639: \"Arabic_ain\",\n  0x063a: \"Arabic_ghain\",\n  0x0640: \"Arabic_tatweel\",\n  0x0641: \"Arabic_feh\",\n  0x0642: \"Arabic_qaf\",\n  0x0643: \"Arabic_kaf\",\n  0x0644: \"Arabic_lam\",\n  0x0645: \"Arabic_meem\",\n  0x0646: \"Arabic_noon\",\n  0x0647: \"Arabic_ha\",\n  0x0648: \"Arabic_waw\",\n  0x0649: \"Arabic_alefmaksura\",\n  0x064a: \"Arabic_yeh\",\n  0x064b: \"Arabic_fathatan\",\n  0x064c: \"Arabic_dammatan\",\n  0x064d: \"Arabic_kasratan\",\n  0x064e: \"Arabic_fatha\",\n  0x064f: \"Arabic_damma\",\n  0x0650: \"Arabic_kasra\",\n  0x0651: \"Arabic_shadda\",\n  0x0652: \"Arabic_sukun\",\n  0x0452: \"Serbian_dje\",\n  0x0453: \"Macedonia_gje\",\n  0x0451: \"Cyrillic_io\",\n  0x0454: \"Ukrainian_ie\",\n  0x0455: \"Macedonia_dse\",\n  0x0456: \"Ukrainian_i\",\n  0x0457: \"Ukrainian_yi\",\n  0x0458: \"Cyrillic_je\",\n  0x0459: \"Cyrillic_lje\",\n  0x045a: \"Cyrillic_nje\",\n  0x045b: \"Serbian_tshe\",\n  0x045c: \"Macedonia_kje\",\n  0x045e: \"Byelorussian_shortu\",\n  0x045f: \"Cyrillic_dzhe\",\n  0x2116: \"numerosign\",\n  0x0402: \"Serbian_DJE\",\n  0x0403: \"Macedonia_GJE\",\n  0x0401: \"Cyrillic_IO\",\n  0x0404: \"Ukrainian_IE\",\n  0x0405: \"Macedonia_DSE\",\n  0x0406: \"Ukrainian_I\",\n  0x0407: \"Ukrainian_YI\",\n  0x0408: \"Cyrillic_JE\",\n  0x0409: \"Cyrillic_LJE\",\n  0x040a: \"Cyrillic_NJE\",\n  0x040b: \"Serbian_TSHE\",\n  0x040c: \"Macedonia_KJE\",\n  0x040e: \"Byelorussian_SHORTU\",\n  0x040f: \"Cyrillic_DZHE\",\n  0x044e: \"Cyrillic_yu\",\n  0x0430: \"Cyrillic_a\",\n  0x0431: \"Cyrillic_be\",\n  0x0446: \"Cyrillic_tse\",\n  0x0434: \"Cyrillic_de\",\n  0x0435: \"Cyrillic_ie\",\n  0x0444: \"Cyrillic_ef\",\n  0x0433: \"Cyrillic_ghe\",\n  0x0445: \"Cyrillic_ha\",\n  0x0438: \"Cyrillic_i\",\n  0x0439: \"Cyrillic_shorti\",\n  0x043a: \"Cyrillic_ka\",\n  0x043b: \"Cyrillic_el\",\n  0x043c: \"Cyrillic_em\",\n  0x043d: \"Cyrillic_en\",\n  0x043e: \"Cyrillic_o\",\n  0x043f: \"Cyrillic_pe\",\n  0x044f: \"Cyrillic_ya\",\n  0x0440: \"Cyrillic_er\",\n  0x0441: \"Cyrillic_es\",\n  0x0442: \"Cyrillic_te\",\n  0x0443: \"Cyrillic_u\",\n  0x0436: \"Cyrillic_zhe\",\n  0x0432: \"Cyrillic_ve\",\n  0x044c: \"Cyrillic_softsign\",\n  0x044b: \"Cyrillic_yeru\",\n  0x0437: \"Cyrillic_ze\",\n  0x0448: \"Cyrillic_sha\",\n  0x044d: \"Cyrillic_e\",\n  0x0449: \"Cyrillic_shcha\",\n  0x0447: \"Cyrillic_che\",\n  0x044a: \"Cyrillic_hardsign\",\n  0x042e: \"Cyrillic_YU\",\n  0x0410: \"Cyrillic_A\",\n  0x0411: \"Cyrillic_BE\",\n  0x0426: \"Cyrillic_TSE\",\n  0x0414: \"Cyrillic_DE\",\n  0x0415: \"Cyrillic_IE\",\n  0x0424: \"Cyrillic_EF\",\n  0x0413: \"Cyrillic_GHE\",\n  0x0425: \"Cyrillic_HA\",\n  0x0418: \"Cyrillic_I\",\n  0x0419: \"Cyrillic_SHORTI\",\n  0x041a: \"Cyrillic_KA\",\n  0x041b: \"Cyrillic_EL\",\n  0x041c: \"Cyrillic_EM\",\n  0x041d: \"Cyrillic_EN\",\n  0x041e: \"Cyrillic_O\",\n  0x041f: \"Cyrillic_PE\",\n  0x042f: \"Cyrillic_YA\",\n  0x0420: \"Cyrillic_ER\",\n  0x0421: \"Cyrillic_ES\",\n  0x0422: \"Cyrillic_TE\",\n  0x0423: \"Cyrillic_U\",\n  0x0416: \"Cyrillic_ZHE\",\n  0x0412: \"Cyrillic_VE\",\n  0x042c: \"Cyrillic_SOFTSIGN\",\n  0x042b: \"Cyrillic_YERU\",\n  0x0417: \"Cyrillic_ZE\",\n  0x0428: \"Cyrillic_SHA\",\n  0x042d: \"Cyrillic_E\",\n  0x0429: \"Cyrillic_SHCHA\",\n  0x0427: \"Cyrillic_CHE\",\n  0x042a: \"Cyrillic_HARDSIGN\",\n  0x0386: \"Greek_ALPHAaccent\",\n  0x0388: \"Greek_EPSILONaccent\",\n  0x0389: \"Greek_ETAaccent\",\n  0x038a: \"Greek_IOTAaccent\",\n  0x03aa: \"Greek_IOTAdiaeresis\",\n  0x038c: \"Greek_OMICRONaccent\",\n  0x038e: \"Greek_UPSILONaccent\",\n  0x03ab: \"Greek_UPSILONdieresis\",\n  0x038f: \"Greek_OMEGAaccent\",\n  0x0385: \"Greek_accentdieresis\",\n  0x2015: \"Greek_horizbar\",\n  0x03ac: \"Greek_alphaaccent\",\n  0x03ad: \"Greek_epsilonaccent\",\n  0x03ae: \"Greek_etaaccent\",\n  0x03af: \"Greek_iotaaccent\",\n  0x03ca: \"Greek_iotadieresis\",\n  0x0390: \"Greek_iotaaccentdieresis\",\n  0x03cc: \"Greek_omicronaccent\",\n  0x03cd: \"Greek_upsilonaccent\",\n  0x03cb: \"Greek_upsilondieresis\",\n  0x03b0: \"Greek_upsilonaccentdieresis\",\n  0x03ce: \"Greek_omegaaccent\",\n  0x0391: \"Greek_ALPHA\",\n  0x0392: \"Greek_BETA\",\n  0x0393: \"Greek_GAMMA\",\n  0x0394: \"Greek_DELTA\",\n  0x0395: \"Greek_EPSILON\",\n  0x0396: \"Greek_ZETA\",\n  0x0397: \"Greek_ETA\",\n  0x0398: \"Greek_THETA\",\n  0x0399: \"Greek_IOTA\",\n  0x039a: \"Greek_KAPPA\",\n  0x039b: \"Greek_LAMBDA\",\n  0x039c: \"Greek_MU\",\n  0x039d: \"Greek_NU\",\n  0x039e: \"Greek_XI\",\n  0x039f: \"Greek_OMICRON\",\n  0x03a0: \"Greek_PI\",\n  0x03a1: \"Greek_RHO\",\n  0x03a3: \"Greek_SIGMA\",\n  0x03a4: \"Greek_TAU\",\n  0x03a5: \"Greek_UPSILON\",\n  0x03a6: \"Greek_PHI\",\n  0x03a7: \"Greek_CHI\",\n  0x03a8: \"Greek_PSI\",\n  0x03a9: \"Greek_OMEGA\",\n  0x03b1: \"Greek_alpha\",\n  0x03b2: \"Greek_beta\",\n  0x03b3: \"Greek_gamma\",\n  0x03b4: \"Greek_delta\",\n  0x03b5: \"Greek_epsilon\",\n  0x03b6: \"Greek_zeta\",\n  0x03b7: \"Greek_eta\",\n  0x03b8: \"Greek_theta\",\n  0x03b9: \"Greek_iota\",\n  0x03ba: \"Greek_kappa\",\n  0x03bb: \"Greek_lambda\",\n  0x03bc: \"Greek_mu\",\n  0x03bd: \"Greek_nu\",\n  0x03be: \"Greek_xi\",\n  0x03bf: \"Greek_omicron\",\n  0x03c0: \"Greek_pi\",\n  0x03c1: \"Greek_rho\",\n  0x03c3: \"Greek_sigma\",\n  0x03c2: \"Greek_finalsmallsigma\",\n  0x03c4: \"Greek_tau\",\n  0x03c5: \"Greek_upsilon\",\n  0x03c6: \"Greek_phi\",\n  0x03c7: \"Greek_chi\",\n  0x03c8: \"Greek_psi\",\n  0x03c9: \"Greek_omega\",\n  0x23b7: \"leftradical\",\n  0x2320: \"topintegral\",\n  0x2321: \"botintegral\",\n  0x23a1: \"topleftsqbracket\",\n  0x23a3: \"botleftsqbracket\",\n  0x23a4: \"toprightsqbracket\",\n  0x23a6: \"botrightsqbracket\",\n  0x239b: \"topleftparens\",\n  0x239d: \"botleftparens\",\n  0x239e: \"toprightparens\",\n  0x23a0: \"botrightparens\",\n  0x23a8: \"leftmiddlecurlybrace\",\n  0x23ac: \"rightmiddlecurlybrace\",\n  0x2264: \"lessthanequal\",\n  0x2260: \"notequal\",\n  0x2265: \"greaterthanequal\",\n  0x222b: \"integral\",\n  0x2234: \"therefore\",\n  0x221d: \"variation\",\n  0x221e: \"infinity\",\n  0x2207: \"nabla\",\n  0x223c: \"approximate\",\n  0x2243: \"similarequal\",\n  0x21d4: \"ifonlyif\",\n  0x21d2: \"implies\",\n  0x2261: \"identical\",\n  0x221a: \"radical\",\n  0x2282: \"includedin\",\n  0x2283: \"includes\",\n  0x2229: \"intersection\",\n  0x222a: \"union\",\n  0x2227: \"logicaland\",\n  0x2228: \"logicalor\",\n  0x2202: \"partialderivative\",\n  0x0192: \"function\",\n  0x2190: \"leftarrow\",\n  0x2191: \"uparrow\",\n  0x2192: \"rightarrow\",\n  0x2193: \"downarrow\",\n  0x25c6: \"soliddiamond\",\n  0x2592: \"checkerboard\",\n  0x2409: \"ht\",\n  0x240c: \"ff\",\n  0x240d: \"cr\",\n  0x240a: \"lf\",\n  0x2424: \"nl\",\n  0x240b: \"vt\",\n  0x2518: \"lowrightcorner\",\n  0x2510: \"uprightcorner\",\n  0x250c: \"upleftcorner\",\n  0x2514: \"lowleftcorner\",\n  0x253c: \"crossinglines\",\n  0x23ba: \"horizlinescan1\",\n  0x23bb: \"horizlinescan3\",\n  0x2500: \"horizlinescan5\",\n  0x23bc: \"horizlinescan7\",\n  0x23bd: \"horizlinescan9\",\n  0x251c: \"leftt\",\n  0x2524: \"rightt\",\n  0x2534: \"bott\",\n  0x252c: \"topt\",\n  0x2502: \"vertbar\",\n  0x2003: \"emspace\",\n  0x2002: \"enspace\",\n  0x2004: \"em3space\",\n  0x2005: \"em4space\",\n  0x2007: \"digitspace\",\n  0x2008: \"punctspace\",\n  0x2009: \"thinspace\",\n  0x200a: \"hairspace\",\n  0x2014: \"emdash\",\n  0x2013: \"endash\",\n  0x2423: \"signifblank\",\n  0x2026: \"ellipsis\",\n  0x2025: \"doubbaselinedot\",\n  0x2153: \"onethird\",\n  0x2154: \"twothirds\",\n  0x2155: \"onefifth\",\n  0x2156: \"twofifths\",\n  0x2157: \"threefifths\",\n  0x2158: \"fourfifths\",\n  0x2159: \"onesixth\",\n  0x215a: \"fivesixths\",\n  0x2105: \"careof\",\n  0x2012: \"figdash\",\n  0x27e8: \"leftanglebracket\",\n  0x27e9: \"rightanglebracket\",\n  0x215b: \"oneeighth\",\n  0x215c: \"threeeighths\",\n  0x215d: \"fiveeighths\",\n  0x215e: \"seveneighths\",\n  0x2122: \"trademark\",\n  0x2613: \"signaturemark\",\n  0x25c1: \"leftopentriangle\",\n  0x25b7: \"rightopentriangle\",\n  0x25af: \"emopenrectangle\",\n  0x2018: \"leftsinglequotemark\",\n  0x2019: \"rightsinglequotemark\",\n  0x201c: \"leftdoublequotemark\",\n  0x201d: \"rightdoublequotemark\",\n  0x211e: \"prescription\",\n  0x2032: \"minutes\",\n  0x2033: \"seconds\",\n  0x271d: \"latincross\",\n  0x25ac: \"filledrectbullet\",\n  0x25c0: \"filledlefttribullet\",\n  0x25b6: \"filledrighttribullet\",\n  0x25cf: \"emfilledcircle\",\n  0x25ae: \"emfilledrect\",\n  0x25e6: \"enopencircbullet\",\n  0x25ab: \"enopensquarebullet\",\n  0x25ad: \"openrectbullet\",\n  0x25b3: \"opentribulletup\",\n  0x25bd: \"opentribulletdown\",\n  0x2606: \"openstar\",\n  0x2022: \"enfilledcircbullet\",\n  0x25aa: \"enfilledsqbullet\",\n  0x25b2: \"filledtribulletup\",\n  0x25bc: \"filledtribulletdown\",\n  0x261c: \"leftpointer\",\n  0x261e: \"rightpointer\",\n  0x2663: \"club\",\n  0x2666: \"diamond\",\n  0x2665: \"heart\",\n  0x2720: \"maltesecross\",\n  0x2020: \"dagger\",\n  0x2021: \"doubledagger\",\n  0x2713: \"checkmark\",\n  0x2717: \"ballotcross\",\n  0x266f: \"musicalsharp\",\n  0x266d: \"musicalflat\",\n  0x2642: \"malesymbol\",\n  0x2640: \"femalesymbol\",\n  0x260e: \"telephone\",\n  0x2315: \"telephonerecorder\",\n  0x2117: \"phonographcopyright\",\n  0x2038: \"caret\",\n  0x201a: \"singlelowquotemark\",\n  0x201e: \"doublelowquotemark\",\n  0x22a5: \"downtack\",\n  0x230a: \"downstile\",\n  0x2218: \"jot\",\n  0x2395: \"quad\",\n  0x22a4: \"uptack\",\n  0x25cb: \"circle\",\n  0x2308: \"upstile\",\n  0x22a2: \"lefttack\",\n  0x22a3: \"righttack\",\n  0x2017: \"hebrew_doublelowline\",\n  0x05d0: \"hebrew_aleph\",\n  0x05d1: \"hebrew_beth\",\n  0x05d2: \"hebrew_gimmel\",\n  0x05d3: \"hebrew_daleth\",\n  0x05d4: \"hebrew_he\",\n  0x05d5: \"hebrew_waw\",\n  0x05d6: \"hebrew_zayin\",\n  0x05d7: \"hebrew_het\",\n  0x05d8: \"hebrew_teth\",\n  0x05d9: \"hebrew_yod\",\n  0x05da: \"hebrew_finalkaph\",\n  0x05db: \"hebrew_kaph\",\n  0x05dc: \"hebrew_lamed\",\n  0x05dd: \"hebrew_finalmem\",\n  0x05de: \"hebrew_mem\",\n  0x05df: \"hebrew_finalnun\",\n  0x05e0: \"hebrew_nun\",\n  0x05e1: \"hebrew_samekh\",\n  0x05e2: \"hebrew_ayin\",\n  0x05e3: \"hebrew_finalpe\",\n  0x05e4: \"hebrew_pe\",\n  0x05e5: \"hebrew_finalzadi\",\n  0x05e6: \"hebrew_zadi\",\n  0x05e7: \"hebrew_qoph\",\n  0x05e8: \"hebrew_resh\",\n  0x05e9: \"hebrew_shin\",\n  0x05ea: \"hebrew_taw\",\n  0x0e01: \"Thai_kokai\",\n  0x0e02: \"Thai_khokhai\",\n  0x0e03: \"Thai_khokhuat\",\n  0x0e04: \"Thai_khokhwai\",\n  0x0e05: \"Thai_khokhon\",\n  0x0e06: \"Thai_khorakhang\",\n  0x0e07: \"Thai_ngongu\",\n  0x0e08: \"Thai_chochan\",\n  0x0e09: \"Thai_choching\",\n  0x0e0a: \"Thai_chochang\",\n  0x0e0b: \"Thai_soso\",\n  0x0e0c: \"Thai_chochoe\",\n  0x0e0d: \"Thai_yoying\",\n  0x0e0e: \"Thai_dochada\",\n  0x0e0f: \"Thai_topatak\",\n  0x0e10: \"Thai_thothan\",\n  0x0e11: \"Thai_thonangmontho\",\n  0x0e12: \"Thai_thophuthao\",\n  0x0e13: \"Thai_nonen\",\n  0x0e14: \"Thai_dodek\",\n  0x0e15: \"Thai_totao\",\n  0x0e16: \"Thai_thothung\",\n  0x0e17: \"Thai_thothahan\",\n  0x0e18: \"Thai_thothong\",\n  0x0e19: \"Thai_nonu\",\n  0x0e1a: \"Thai_bobaimai\",\n  0x0e1b: \"Thai_popla\",\n  0x0e1c: \"Thai_phophung\",\n  0x0e1d: \"Thai_fofa\",\n  0x0e1e: \"Thai_phophan\",\n  0x0e1f: \"Thai_fofan\",\n  0x0e20: \"Thai_phosamphao\",\n  0x0e21: \"Thai_moma\",\n  0x0e22: \"Thai_yoyak\",\n  0x0e23: \"Thai_rorua\",\n  0x0e24: \"Thai_ru\",\n  0x0e25: \"Thai_loling\",\n  0x0e26: \"Thai_lu\",\n  0x0e27: \"Thai_wowaen\",\n  0x0e28: \"Thai_sosala\",\n  0x0e29: \"Thai_sorusi\",\n  0x0e2a: \"Thai_sosua\",\n  0x0e2b: \"Thai_hohip\",\n  0x0e2c: \"Thai_lochula\",\n  0x0e2d: \"Thai_oang\",\n  0x0e2e: \"Thai_honokhuk\",\n  0x0e2f: \"Thai_paiyannoi\",\n  0x0e30: \"Thai_saraa\",\n  0x0e31: \"Thai_maihanakat\",\n  0x0e32: \"Thai_saraaa\",\n  0x0e33: \"Thai_saraam\",\n  0x0e34: \"Thai_sarai\",\n  0x0e35: \"Thai_saraii\",\n  0x0e36: \"Thai_saraue\",\n  0x0e37: \"Thai_sarauee\",\n  0x0e38: \"Thai_sarau\",\n  0x0e39: \"Thai_sarauu\",\n  0x0e3a: \"Thai_phinthu\",\n  0x0e3f: \"Thai_baht\",\n  0x0e40: \"Thai_sarae\",\n  0x0e41: \"Thai_saraae\",\n  0x0e42: \"Thai_sarao\",\n  0x0e43: \"Thai_saraaimaimuan\",\n  0x0e44: \"Thai_saraaimaimalai\",\n  0x0e45: \"Thai_lakkhangyao\",\n  0x0e46: \"Thai_maiyamok\",\n  0x0e47: \"Thai_maitaikhu\",\n  0x0e48: \"Thai_maiek\",\n  0x0e49: \"Thai_maitho\",\n  0x0e4a: \"Thai_maitri\",\n  0x0e4b: \"Thai_maichattawa\",\n  0x0e4c: \"Thai_thanthakhat\",\n  0x0e4d: \"Thai_nikhahit\",\n  0x0e50: \"Thai_leksun\",\n  0x0e51: \"Thai_leknung\",\n  0x0e52: \"Thai_leksong\",\n  0x0e53: \"Thai_leksam\",\n  0x0e54: \"Thai_leksi\",\n  0x0e55: \"Thai_lekha\",\n  0x0e56: \"Thai_lekhok\",\n  0x0e57: \"Thai_lekchet\",\n  0x0e58: \"Thai_lekpaet\",\n  0x0e59: \"Thai_lekkao\",\n  0x3131: \"Hangul_Kiyeog\",\n  0x3132: \"Hangul_SsangKiyeog\",\n  0x3133: \"Hangul_KiyeogSios\",\n  0x3134: \"Hangul_Nieun\",\n  0x3135: \"Hangul_NieunJieuj\",\n  0x3136: \"Hangul_NieunHieuh\",\n  0x3137: \"Hangul_Dikeud\",\n  0x3138: \"Hangul_SsangDikeud\",\n  0x3139: \"Hangul_Rieul\",\n  0x313a: \"Hangul_RieulKiyeog\",\n  0x313b: \"Hangul_RieulMieum\",\n  0x313c: \"Hangul_RieulPieub\",\n  0x313d: \"Hangul_RieulSios\",\n  0x313e: \"Hangul_RieulTieut\",\n  0x313f: \"Hangul_RieulPhieuf\",\n  0x3140: \"Hangul_RieulHieuh\",\n  0x3141: \"Hangul_Mieum\",\n  0x3142: \"Hangul_Pieub\",\n  0x3143: \"Hangul_SsangPieub\",\n  0x3144: \"Hangul_PieubSios\",\n  0x3145: \"Hangul_Sios\",\n  0x3146: \"Hangul_SsangSios\",\n  0x3147: \"Hangul_Ieung\",\n  0x3148: \"Hangul_Jieuj\",\n  0x3149: \"Hangul_SsangJieuj\",\n  0x314a: \"Hangul_Cieuc\",\n  0x314b: \"Hangul_Khieuq\",\n  0x314c: \"Hangul_Tieut\",\n  0x314d: \"Hangul_Phieuf\",\n  0x314e: \"Hangul_Hieuh\",\n  0x314f: \"Hangul_A\",\n  0x3150: \"Hangul_AE\",\n  0x3151: \"Hangul_YA\",\n  0x3152: \"Hangul_YAE\",\n  0x3153: \"Hangul_EO\",\n  0x3154: \"Hangul_E\",\n  0x3155: \"Hangul_YEO\",\n  0x3156: \"Hangul_YE\",\n  0x3157: \"Hangul_O\",\n  0x3158: \"Hangul_WA\",\n  0x3159: \"Hangul_WAE\",\n  0x315a: \"Hangul_OE\",\n  0x315b: \"Hangul_YO\",\n  0x315c: \"Hangul_U\",\n  0x315d: \"Hangul_WEO\",\n  0x315e: \"Hangul_WE\",\n  0x315f: \"Hangul_WI\",\n  0x3160: \"Hangul_YU\",\n  0x3161: \"Hangul_EU\",\n  0x3162: \"Hangul_YI\",\n  0x3163: \"Hangul_I\",\n  0x11a8: \"Hangul_J_Kiyeog\",\n  0x11a9: \"Hangul_J_SsangKiyeog\",\n  0x11aa: \"Hangul_J_KiyeogSios\",\n  0x11ab: \"Hangul_J_Nieun\",\n  0x11ac: \"Hangul_J_NieunJieuj\",\n  0x11ad: \"Hangul_J_NieunHieuh\",\n  0x11ae: \"Hangul_J_Dikeud\",\n  0x11af: \"Hangul_J_Rieul\",\n  0x11b0: \"Hangul_J_RieulKiyeog\",\n  0x11b1: \"Hangul_J_RieulMieum\",\n  0x11b2: \"Hangul_J_RieulPieub\",\n  0x11b3: \"Hangul_J_RieulSios\",\n  0x11b4: \"Hangul_J_RieulTieut\",\n  0x11b5: \"Hangul_J_RieulPhieuf\",\n  0x11b6: \"Hangul_J_RieulHieuh\",\n  0x11b7: \"Hangul_J_Mieum\",\n  0x11b8: \"Hangul_J_Pieub\",\n  0x11b9: \"Hangul_J_PieubSios\",\n  0x11ba: \"Hangul_J_Sios\",\n  0x11bb: \"Hangul_J_SsangSios\",\n  0x11bc: \"Hangul_J_Ieung\",\n  0x11bd: \"Hangul_J_Jieuj\",\n  0x11be: \"Hangul_J_Cieuc\",\n  0x11bf: \"Hangul_J_Khieuq\",\n  0x11c0: \"Hangul_J_Tieut\",\n  0x11c1: \"Hangul_J_Phieuf\",\n  0x11c2: \"Hangul_J_Hieuh\",\n  0x316d: \"Hangul_RieulYeorinHieuh\",\n  0x3171: \"Hangul_SunkyeongeumMieum\",\n  0x3178: \"Hangul_SunkyeongeumPieub\",\n  0x317f: \"Hangul_PanSios\",\n  0x3181: \"Hangul_KkogjiDalrinIeung\",\n  0x3184: \"Hangul_SunkyeongeumPhieuf\",\n  0x3186: \"Hangul_YeorinHieuh\",\n  0x318d: \"Hangul_AraeA\",\n  0x318e: \"Hangul_AraeAE\",\n  0x11eb: \"Hangul_J_PanSios\",\n  0x11f0: \"Hangul_J_KkogjiDalrinIeung\",\n  0x11f9: \"Hangul_J_YeorinHieuh\",\n  0x0152: \"OE\",\n  0x0153: \"oe\",\n  0x0178: \"Ydiaeresis\",\n  0x20a0: \"EcuSign\",\n  0x20a1: \"ColonSign\",\n  0x20a2: \"CruzeiroSign\",\n  0x20a3: \"FFrancSign\",\n  0x20a4: \"LiraSign\",\n  0x20a5: \"MillSign\",\n  0x20a6: \"NairaSign\",\n  0x20a7: \"PesetaSign\",\n  0x20a8: \"RupeeSign\",\n  0x20a9: \"WonSign\",\n  0x20aa: \"NewSheqelSign\",\n  0x20ab: \"DongSign\",\n  0x20ac: \"EuroSign\",\n  0x0300: \"dead_grave\",\n  0x0301: \"dead_acute\",\n  0x0302: \"dead_circumflex\",\n  0x0303: \"dead_tilde\",\n  0x0304: \"dead_macron\",\n  0x0306: \"dead_breve\",\n  0x0307: \"dead_abovedot\",\n  0x0308: \"dead_diaeresis\",\n  0x030a: \"dead_abovering\",\n  0x030b: \"dead_doubleacute\",\n  0x030c: \"dead_caron\",\n  0x0327: \"dead_cedilla\",\n  0x0328: \"dead_ogonek\",\n  0x0345: \"dead_iota\",\n  0x3099: \"dead_voiced_sound\",\n  0x309a: \"dead_semivoiced_sound\",\n  0x0008: \"BackSpace\",\n  0x0009: \"Tab\",\n  0x000a: \"Linefeed\",\n  0x000b: \"Clear\",\n  0x000d: \"Return\",\n  0x0013: \"Pause\",\n  0x0014: \"Scroll_Lock\",\n  0x0015: \"Sys_Req\",\n  0x001b: \"Escape\",\n  0x0491: \"Ukrainian_ghe_with_upturn\",\n  0x0490: \"Ukrainian_GHE_WITH_UPTURN\",\n  0x0587: \"Armenian_ligature_ew\",\n  0x0589: \"Armenian_verjaket\",\n  0x055d: \"Armenian_but\",\n  0x058a: \"Armenian_yentamna\",\n  0x055c: \"Armenian_amanak\",\n  0x055b: \"Armenian_shesht\",\n  0x055e: \"Armenian_paruyk\",\n  0x0531: \"Armenian_AYB\",\n  0x0561: \"Armenian_ayb\",\n  0x0532: \"Armenian_BEN\",\n  0x0562: \"Armenian_ben\",\n  0x0533: \"Armenian_GIM\",\n  0x0563: \"Armenian_gim\",\n  0x0534: \"Armenian_DA\",\n  0x0564: \"Armenian_da\",\n  0x0535: \"Armenian_YECH\",\n  0x0565: \"Armenian_yech\",\n  0x0536: \"Armenian_ZA\",\n  0x0566: \"Armenian_za\",\n  0x0537: \"Armenian_E\",\n  0x0567: \"Armenian_e\",\n  0x0538: \"Armenian_AT\",\n  0x0568: \"Armenian_at\",\n  0x0539: \"Armenian_TO\",\n  0x0569: \"Armenian_to\",\n  0x053a: \"Armenian_ZHE\",\n  0x056a: \"Armenian_zhe\",\n  0x053b: \"Armenian_INI\",\n  0x056b: \"Armenian_ini\",\n  0x053c: \"Armenian_LYUN\",\n  0x056c: \"Armenian_lyun\",\n  0x053d: \"Armenian_KHE\",\n  0x056d: \"Armenian_khe\",\n  0x053e: \"Armenian_TSA\",\n  0x056e: \"Armenian_tsa\",\n  0x053f: \"Armenian_KEN\",\n  0x056f: \"Armenian_ken\",\n  0x0540: \"Armenian_HO\",\n  0x0570: \"Armenian_ho\",\n  0x0541: \"Armenian_DZA\",\n  0x0571: \"Armenian_dza\",\n  0x0542: \"Armenian_GHAT\",\n  0x0572: \"Armenian_ghat\",\n  0x0543: \"Armenian_TCHE\",\n  0x0573: \"Armenian_tche\",\n  0x0544: \"Armenian_MEN\",\n  0x0574: \"Armenian_men\",\n  0x0545: \"Armenian_HI\",\n  0x0575: \"Armenian_hi\",\n  0x0546: \"Armenian_NU\",\n  0x0576: \"Armenian_nu\",\n  0x0547: \"Armenian_SHA\",\n  0x0577: \"Armenian_sha\",\n  0x0548: \"Armenian_VO\",\n  0x0578: \"Armenian_vo\",\n  0x0549: \"Armenian_CHA\",\n  0x0579: \"Armenian_cha\",\n  0x054a: \"Armenian_PE\",\n  0x057a: \"Armenian_pe\",\n  0x054b: \"Armenian_JE\",\n  0x057b: \"Armenian_je\",\n  0x054c: \"Armenian_RA\",\n  0x057c: \"Armenian_ra\",\n  0x054d: \"Armenian_SE\",\n  0x057d: \"Armenian_se\",\n  0x054e: \"Armenian_VEV\",\n  0x057e: \"Armenian_vev\",\n  0x054f: \"Armenian_TYUN\",\n  0x057f: \"Armenian_tyun\",\n  0x0550: \"Armenian_RE\",\n  0x0580: \"Armenian_re\",\n  0x0551: \"Armenian_TSO\",\n  0x0581: \"Armenian_tso\",\n  0x0552: \"Armenian_VYUN\",\n  0x0582: \"Armenian_vyun\",\n  0x0553: \"Armenian_PYUR\",\n  0x0583: \"Armenian_pyur\",\n  0x0554: \"Armenian_KE\",\n  0x0584: \"Armenian_ke\",\n  0x0555: \"Armenian_O\",\n  0x0585: \"Armenian_o\",\n  0x0556: \"Armenian_FE\",\n  0x0586: \"Armenian_fe\",\n  0x055a: \"Armenian_apostrophe\",\n  0x10d0: \"Georgian_an\",\n  0x10d1: \"Georgian_ban\",\n  0x10d2: \"Georgian_gan\",\n  0x10d3: \"Georgian_don\",\n  0x10d4: \"Georgian_en\",\n  0x10d5: \"Georgian_vin\",\n  0x10d6: \"Georgian_zen\",\n  0x10d7: \"Georgian_tan\",\n  0x10d8: \"Georgian_in\",\n  0x10d9: \"Georgian_kan\",\n  0x10da: \"Georgian_las\",\n  0x10db: \"Georgian_man\",\n  0x10dc: \"Georgian_nar\",\n  0x10dd: \"Georgian_on\",\n  0x10de: \"Georgian_par\",\n  0x10df: \"Georgian_zhar\",\n  0x10e0: \"Georgian_rae\",\n  0x10e1: \"Georgian_san\",\n  0x10e2: \"Georgian_tar\",\n  0x10e3: \"Georgian_un\",\n  0x10e4: \"Georgian_phar\",\n  0x10e5: \"Georgian_khar\",\n  0x10e6: \"Georgian_ghan\",\n  0x10e7: \"Georgian_qar\",\n  0x10e8: \"Georgian_shin\",\n  0x10e9: \"Georgian_chin\",\n  0x10ea: \"Georgian_can\",\n  0x10eb: \"Georgian_jil\",\n  0x10ec: \"Georgian_cil\",\n  0x10ed: \"Georgian_char\",\n  0x10ee: \"Georgian_xan\",\n  0x10ef: \"Georgian_jhan\",\n  0x10f0: \"Georgian_hae\",\n  0x10f1: \"Georgian_he\",\n  0x10f2: \"Georgian_hie\",\n  0x10f3: \"Georgian_we\",\n  0x10f4: \"Georgian_har\",\n  0x10f5: \"Georgian_hoe\",\n  0x10f6: \"Georgian_fi\",\n  0x1e02: \"Babovedot\",\n  0x1e03: \"babovedot\",\n  0x1e0a: \"Dabovedot\",\n  0x1e80: \"Wgrave\",\n  0x1e82: \"Wacute\",\n  0x1e0b: \"dabovedot\",\n  0x1ef2: \"Ygrave\",\n  0x1e1e: \"Fabovedot\",\n  0x1e1f: \"fabovedot\",\n  0x1e40: \"Mabovedot\",\n  0x1e41: \"mabovedot\",\n  0x1e56: \"Pabovedot\",\n  0x1e81: \"wgrave\",\n  0x1e57: \"pabovedot\",\n  0x1e83: \"wacute\",\n  0x1e60: \"Sabovedot\",\n  0x1ef3: \"ygrave\",\n  0x1e84: \"Wdiaeresis\",\n  0x1e85: \"wdiaeresis\",\n  0x1e61: \"sabovedot\",\n  0x0174: \"Wcircumflex\",\n  0x1e6a: \"Tabovedot\",\n  0x0176: \"Ycircumflex\",\n  0x0175: \"wcircumflex\",\n  0x1e6b: \"tabovedot\",\n  0x0177: \"ycircumflex\",\n  0x06f0: \"Farsi_0\",\n  0x06f1: \"Farsi_1\",\n  0x06f2: \"Farsi_2\",\n  0x06f3: \"Farsi_3\",\n  0x06f4: \"Farsi_4\",\n  0x06f5: \"Farsi_5\",\n  0x06f6: \"Farsi_6\",\n  0x06f7: \"Farsi_7\",\n  0x06f8: \"Farsi_8\",\n  0x06f9: \"Farsi_9\",\n  0x066a: \"Arabic_percent\",\n  0x0670: \"Arabic_superscript_alef\",\n  0x0679: \"Arabic_tteh\",\n  0x067e: \"Arabic_peh\",\n  0x0686: \"Arabic_tcheh\",\n  0x0688: \"Arabic_ddal\",\n  0x0691: \"Arabic_rreh\",\n  0x06d4: \"Arabic_fullstop\",\n  0x0660: \"Arabic_0\",\n  0x0661: \"Arabic_1\",\n  0x0662: \"Arabic_2\",\n  0x0663: \"Arabic_3\",\n  0x0664: \"Arabic_4\",\n  0x0665: \"Arabic_5\",\n  0x0666: \"Arabic_6\",\n  0x0667: \"Arabic_7\",\n  0x0668: \"Arabic_8\",\n  0x0669: \"Arabic_9\",\n  0x0653: \"Arabic_madda_above\",\n  0x0654: \"Arabic_hamza_above\",\n  0x0655: \"Arabic_hamza_below\",\n  0x0698: \"Arabic_jeh\",\n  0x06a4: \"Arabic_veh\",\n  0x06a9: \"Arabic_keheh\",\n  0x06af: \"Arabic_gaf\",\n  0x06ba: \"Arabic_noon_ghunna\",\n  0x06be: \"Arabic_heh_doachashmee\",\n  0x06cc: \"Farsi_yeh\",\n  0x06d2: \"Arabic_yeh_baree\",\n  0x06c1: \"Arabic_heh_goal\",\n  0x0492: \"Cyrillic_GHE_bar\",\n  0x0496: \"Cyrillic_ZHE_descender\",\n  0x049a: \"Cyrillic_KA_descender\",\n  0x049c: \"Cyrillic_KA_vertstroke\",\n  0x04a2: \"Cyrillic_EN_descender\",\n  0x04ae: \"Cyrillic_U_straight\",\n  0x04b0: \"Cyrillic_U_straight_bar\",\n  0x04b2: \"Cyrillic_HA_descender\",\n  0x04b6: \"Cyrillic_CHE_descender\",\n  0x04b8: \"Cyrillic_CHE_vertstroke\",\n  0x04ba: \"Cyrillic_SHHA\",\n  0x04d8: \"Cyrillic_SCHWA\",\n  0x04e2: \"Cyrillic_I_macron\",\n  0x04e8: \"Cyrillic_O_bar\",\n  0x04ee: \"Cyrillic_U_macron\",\n  0x0493: \"Cyrillic_ghe_bar\",\n  0x0497: \"Cyrillic_zhe_descender\",\n  0x049b: \"Cyrillic_ka_descender\",\n  0x049d: \"Cyrillic_ka_vertstroke\",\n  0x04a3: \"Cyrillic_en_descender\",\n  0x04af: \"Cyrillic_u_straight\",\n  0x04b1: \"Cyrillic_u_straight_bar\",\n  0x04b3: \"Cyrillic_ha_descender\",\n  0x04b7: \"Cyrillic_che_descender\",\n  0x04b9: \"Cyrillic_che_vertstroke\",\n  0x04bb: \"Cyrillic_shha\",\n  0x04d9: \"Cyrillic_schwa\",\n  0x04e3: \"Cyrillic_i_macron\",\n  0x04e9: \"Cyrillic_o_bar\",\n  0x04ef: \"Cyrillic_u_macron\",\n  0x1e8a: \"Xabovedot\",\n  0x012c: \"Ibreve\",\n  0x01b5: \"Zstroke\",\n  0x01e6: \"Gcaron\",\n  0x019f: \"Obarred\",\n  0x1e8b: \"xabovedot\",\n  0x012d: \"ibreve\",\n  0x01b6: \"zstroke\",\n  0x01e7: \"gcaron\",\n  0x01d2: \"ocaron\",\n  0x0275: \"obarred\",\n  0x018f: \"SCHWA\",\n  0x0259: \"schwa\",\n  0x1e36: \"Lbelowdot\",\n  0x1e37: \"lbelowdot\",\n  0x1ea0: \"Abelowdot\",\n  0x1ea1: \"abelowdot\",\n  0x1ea2: \"Ahook\",\n  0x1ea3: \"ahook\",\n  0x1ea4: \"Acircumflexacute\",\n  0x1ea5: \"acircumflexacute\",\n  0x1ea6: \"Acircumflexgrave\",\n  0x1ea7: \"acircumflexgrave\",\n  0x1ea8: \"Acircumflexhook\",\n  0x1ea9: \"acircumflexhook\",\n  0x1eaa: \"Acircumflextilde\",\n  0x1eab: \"acircumflextilde\",\n  0x1eac: \"Acircumflexbelowdot\",\n  0x1ead: \"acircumflexbelowdot\",\n  0x1eae: \"Abreveacute\",\n  0x1eaf: \"abreveacute\",\n  0x1eb0: \"Abrevegrave\",\n  0x1eb1: \"abrevegrave\",\n  0x1eb2: \"Abrevehook\",\n  0x1eb3: \"abrevehook\",\n  0x1eb4: \"Abrevetilde\",\n  0x1eb5: \"abrevetilde\",\n  0x1eb6: \"Abrevebelowdot\",\n  0x1eb7: \"abrevebelowdot\",\n  0x1eb8: \"Ebelowdot\",\n  0x1eb9: \"ebelowdot\",\n  0x1eba: \"Ehook\",\n  0x1ebb: \"ehook\",\n  0x1ebc: \"Etilde\",\n  0x1ebd: \"etilde\",\n  0x1ebe: \"Ecircumflexacute\",\n  0x1ebf: \"ecircumflexacute\",\n  0x1ec0: \"Ecircumflexgrave\",\n  0x1ec1: \"ecircumflexgrave\",\n  0x1ec2: \"Ecircumflexhook\",\n  0x1ec3: \"ecircumflexhook\",\n  0x1ec4: \"Ecircumflextilde\",\n  0x1ec5: \"ecircumflextilde\",\n  0x1ec6: \"Ecircumflexbelowdot\",\n  0x1ec7: \"ecircumflexbelowdot\",\n  0x1ec8: \"Ihook\",\n  0x1ec9: \"ihook\",\n  0x1eca: \"Ibelowdot\",\n  0x1ecb: \"ibelowdot\",\n  0x1ecc: \"Obelowdot\",\n  0x1ecd: \"obelowdot\",\n  0x1ece: \"Ohook\",\n  0x1ecf: \"ohook\",\n  0x1ed0: \"Ocircumflexacute\",\n  0x1ed1: \"ocircumflexacute\",\n  0x1ed2: \"Ocircumflexgrave\",\n  0x1ed3: \"ocircumflexgrave\",\n  0x1ed4: \"Ocircumflexhook\",\n  0x1ed5: \"ocircumflexhook\",\n  0x1ed6: \"Ocircumflextilde\",\n  0x1ed7: \"ocircumflextilde\",\n  0x1ed8: \"Ocircumflexbelowdot\",\n  0x1ed9: \"ocircumflexbelowdot\",\n  0x1eda: \"Ohornacute\",\n  0x1edb: \"ohornacute\",\n  0x1edc: \"Ohorngrave\",\n  0x1edd: \"ohorngrave\",\n  0x1ede: \"Ohornhook\",\n  0x1edf: \"ohornhook\",\n  0x1ee0: \"Ohorntilde\",\n  0x1ee1: \"ohorntilde\",\n  0x1ee2: \"Ohornbelowdot\",\n  0x1ee3: \"ohornbelowdot\",\n  0x1ee4: \"Ubelowdot\",\n  0x1ee5: \"ubelowdot\",\n  0x1ee6: \"Uhook\",\n  0x1ee7: \"uhook\",\n  0x1ee8: \"Uhornacute\",\n  0x1ee9: \"uhornacute\",\n  0x1eea: \"Uhorngrave\",\n  0x1eeb: \"uhorngrave\",\n  0x1eec: \"Uhornhook\",\n  0x1eed: \"uhornhook\",\n  0x1eee: \"Uhorntilde\",\n  0x1eef: \"uhorntilde\",\n  0x1ef0: \"Uhornbelowdot\",\n  0x1ef1: \"uhornbelowdot\",\n  0x1ef4: \"Ybelowdot\",\n  0x1ef5: \"ybelowdot\",\n  0x1ef6: \"Yhook\",\n  0x1ef7: \"yhook\",\n  0x1ef8: \"Ytilde\",\n  0x1ef9: \"ytilde\",\n  0x01a0: \"Ohorn\",\n  0x01a1: \"ohorn\",\n  0x01af: \"Uhorn\",\n  0x01b0: \"uhorn\",\n  0x0323: \"dead_belowdot\",\n  0x0309: \"dead_hook\",\n  0x031b: \"dead_horn\"\n});\n\n// mapping is based on https://developer.mozilla.org/en-US/docs/Web/API/UI_Events/Keyboard_event_key_values\nconst kbEventCodesToKeySyms = Object.freeze({\n  \"AltLeft\": \"Alt_L\",\n  \"AltRight\": \"Alt_R\",\n  \"ArrowDown\": \"Down\",\n  \"ArrowLeft\": \"Left\",\n  \"ArrowRight\": \"Right\",\n  \"ArrowUp\": \"Up\",\n  \"Backspace\": \"BackSpace\",\n  \"CapsLock\": \"Caps_Lock\",\n  \"ControlLeft\": \"Control_L\",\n  \"ControlRight\": \"Control_R\",\n  \"Enter\": \"Return\",\n  \"HyperLeft\": \"Hyper_L\",\n  \"HyperRight\": \"Hyper_R\",\n  \"NumLock\": \"Num_Lock\",\n  \"NumpadEnter\": \"Return\",\n  \"MetaLeft\": \"Meta_L\",\n  \"MetaRight\": \"Meta_R\",\n  \"PageDown\": \"Page_Down\",\n  \"PageUp\": \"Page_Up\",\n  \"ScrollLock\": \"Scroll_Lock\",\n  \"ShiftLeft\": \"Shift_L\",\n  \"ShiftRight\": \"Shift_R\",\n  \"SuperLeft\": \"Super_L\",\n  \"SuperRight\": \"Super_R\"\n});\n\n// these Keyboard Event codes direclty map to X11 Keysyms\nconst knownKbEventCodes = new Set([\n  \"Clear\", \"Copy\", \"Cut\", \"Delete\", \"End\", \"F1\", \"F2\", \"F3\", \"F4\", \"F5\", \"F6\", \"F7\", \"F8\", \"F9\", \"F10\", \"F11\", \"F12\",\n  \"Home\", \"Insert\", \"Paste\", \"Redo\", \"Tab\", \"Undo\"\n]);\n\n/**\n * Returns X11 keySym (defined in https://www.cl.cam.ac.uk/~mgk25/ucs/keysyms.txt) for a given key/code from the key[up/down] event\n * For keys with length 1 (ASCII, Cyrillic etc) - uses uniToKeySyms mapping\n * For keys with length > 1 (Modifiers, Whitespaces, Navigation etc) - uses knownKbEventCodes and kbEventCodesToKeySyms mapping\n *\n * @param {string} key 'key' from the key[up/down] event\n * @param {string} code 'code' from the key[up/down] event\n * @return {string} keySymString (X11 keysym string)\n */\nexport default function getKeysymString(key, code) {\n  var keySym = \"Unidentified\";\n  if (key.length === 1) {\n    const keyCodeUni = key.charCodeAt(0);\n    if (keyCodeUni in uniToKeySyms) {\n      keySym = uniToKeySyms[keyCodeUni];\n    }\n  } else if (code in kbEventCodesToKeySyms) {\n    keySym = kbEventCodesToKeySyms[code];\n  } else if (knownKbEventCodes.has(code)) {\n    keySym = code;\n  }\n  return keySym;\n}\n","/*\n * gstwebrtc-api\n *\n * Copyright (C) 2022 Igalia S.L. <info@igalia.com>\n *   Author: Loc Le Page <llepage@igalia.com>\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\nimport getKeysymString from \"./keysyms.js\";\n\n/** @import ConsumerSession from \"./consumer-session.js\"; */\n\nconst eventsNames = Object.freeze([\n  \"wheel\",\n  \"contextmenu\",\n  \"mousemove\",\n  \"mousedown\",\n  \"mouseup\",\n  \"touchstart\",\n  \"touchend\",\n  \"touchmove\",\n  \"touchcancel\",\n  \"keyup\",\n  \"keydown\"\n]);\n\nconst mouseEventsNames = Object.freeze({\n  mousemove: \"MouseMove\",\n  mousedown: \"MouseButtonPress\",\n  mouseup: \"MouseButtonRelease\"\n});\n\nconst touchEventsNames = Object.freeze({\n  touchstart: \"TouchDown\",\n  touchend: \"TouchUp\",\n  touchmove: \"TouchMotion\",\n  touchcancel: \"TouchUp\"\n});\n\nconst keyboardEventsNames = Object.freeze({\n  keydown: \"KeyPress\",\n  keyup: \"KeyRelease\"\n});\n\nfunction getModifiers(event) {\n  const modifiers = [];\n  if (event.altKey) {\n    modifiers.push(\"mod1-mask\");\n  }\n\n  if (event.ctrlKey) {\n    modifiers.push(\"control-mask\");\n  }\n\n  if (event.metaKey) {\n    modifiers.push(\"meta-mask\");\n  }\n\n  if (event.shiftKey) {\n    modifiers.push(\"shift-mask\");\n  }\n\n  return modifiers.join(\"+\");\n}\n\n/**\n * Event name: \"info\".<br>\n * Triggered when a remote peer sends an information message over the control data channel.\n * @event GstWebRTCAPI#InfoEvent\n * @type {CustomEvent}\n * @property {object} detail - The info message\n * @see RemoteController\n */\n/**\n * Event name: \"controlResponse\".<br>\n * Triggered when a remote peer sends a response after a control request.\n * @event GstWebRTCAPI#ControlResponseEvent\n * @type {CustomEvent}\n * @property {object} detail - The response message\n * @see RemoteController\n */\n\n/**\n * @class RemoteController\n * @hideconstructor\n * @classdesc Manages a specific WebRTC data channel created by a remote GStreamer webrtcsink producer and offering\n * remote control of the producer through\n * [GstNavigation]{@link https://gstreamer.freedesktop.org/documentation/video/gstnavigation.html} events.\n * <p>The remote control data channel is created by the GStreamer webrtcsink element on the producer side. Then it is\n * announced through the consumer session thanks to the {@link gstWebRTCAPI#event:RemoteControllerChangedEvent}\n * event.</p>\n * <p>You can attach an {@link HTMLVideoElement} to the remote controller, then all mouse and keyboard events\n * emitted by this element will be automatically relayed to the remote producer.</p>\n * @extends {EventTarget}\n * @fires {@link GstWebRTCAPI#event:ErrorEvent}\n * @fires {@link GstWebRTCAPI#event:ClosedEvent}\n * @fires {@link GstWebRTCAPI#event:InfoEvent}\n * @fires {@link GstWebRTCAPI#event:ControlResponseEvent}\n * @see ConsumerSession#remoteController\n * @see RemoteController#attachVideoElement\n * @see https://gitlab.freedesktop.org/gstreamer/gst-plugins-rs/-/tree/main/net/webrtc/gstwebrtc-api#produce-a-gstreamer-interactive-webrtc-stream-with-remote-control\n */\nclass RemoteController extends EventTarget {\n  constructor(rtcDataChannel, consumerSession) {\n    super();\n\n    this._rtcDataChannel = rtcDataChannel;\n    this._consumerSession = consumerSession;\n\n    this._videoElement = null;\n    this._videoElementComputedStyle = null;\n    this._videoElementKeyboard = null;\n    this._lastTouchEventTimestamp = 0;\n    this._requestCounter = 0;\n\n    rtcDataChannel.addEventListener(\"close\", () => {\n      if (this._rtcDataChannel === rtcDataChannel) {\n        this.close();\n      }\n    });\n\n    rtcDataChannel.addEventListener(\"error\", (event) => {\n      if (this._rtcDataChannel === rtcDataChannel) {\n        const error = event.error;\n        this.dispatchEvent(new ErrorEvent(\"error\", {\n          message: (error && error.message) || \"Remote controller error\",\n          error: error || new Error(\"unknown error on the remote controller data channel\")\n        }));\n      }\n    });\n\n    rtcDataChannel.addEventListener(\"message\", (event) => {\n      try {\n        const msg = JSON.parse(event.data);\n\n        if (msg.type === \"ControlResponseMessage\") {\n          this.dispatchEvent(new CustomEvent(\"controlResponse\", { detail: msg }));\n        } else if (msg.type === \"InfoMessage\") {\n          this.dispatchEvent(new CustomEvent(\"info\", { detail: msg }));\n        }\n      } catch (ex) {\n        this.dispatchEvent(new ErrorEvent(\"error\", {\n          message: \"cannot parse control message from signaling server\",\n          error: ex\n        }));\n      }\n    });\n  }\n\n\n  /**\n   * The underlying WebRTC data channel connected to a remote GStreamer webrtcsink producer offering remote control.\n   * The value may be null if the remote controller has been closed.\n   * @type {RTCDataChannel}\n   * @readonly\n   */\n  get rtcDataChannel() {\n    return this._rtcDataChannel;\n  }\n\n  /**\n   * The consumer session associated with this remote controller.\n   * @type {ConsumerSession}\n   * @readonly\n   */\n  get consumerSession() {\n    return this._consumerSession;\n  }\n\n  /**\n   * The video element that is currently used to send all mouse and keyboard events to the remote producer. Value may\n   * be null if no video element is attached.\n   * @type {HTMLVideoElement}\n   * @readonly\n   * @see RemoteController#attachVideoElement\n   */\n  get videoElement() {\n    return this._videoElement;\n  }\n\n  /**\n   * Associates a video element with this remote controller.<br>\n   * When a video element is attached to this remote controller, all mouse and keyboard events emitted by this\n   * element will be sent to the remote GStreamer webrtcink producer.\n   * @param {HTMLVideoElement|null} element - the video element to use to relay mouse and keyboard events,\n   * or null to detach any previously attached element. If the provided element parameter is not null and not a\n   * valid instance of an {@link HTMLVideoElement}, then the method does nothing.\n   */\n  attachVideoElement(element) {\n    if ((element instanceof HTMLVideoElement) && (element !== this._videoElement)) {\n      if (this._videoElement) {\n        this.attachVideoElement(null);\n      }\n\n      this._videoElement = element;\n      this._videoElementComputedStyle = window.getComputedStyle(element);\n\n      for (const eventName of eventsNames) {\n        element.addEventListener(eventName, this);\n      }\n\n      element.setAttribute(\"tabindex\", \"0\");\n    } else if ((element === null) && this._videoElement) {\n      const previousElement = this._videoElement;\n      previousElement.removeAttribute(\"tabindex\");\n\n      this._videoElement = null;\n      this._videoElementComputedStyle = null;\n\n      this._lastTouchEventTimestamp = 0;\n\n      for (const eventName of eventsNames) {\n        previousElement.removeEventListener(eventName, this);\n      }\n    }\n  }\n\n  /**\n   * Send a request over the control data channel.<br>\n   *\n   * @fires {@link GstWebRTCAPI#event:ErrorEvent}\n   * @param {object|string} request - The request to send over the channel\n   * @returns {number} The identifier attributed to the request, or -1 if an exception occurred\n   */\n  sendControlRequest(request) {\n    try {\n      if (!request || ((typeof (request) !== \"object\") && (typeof (request) !== \"string\"))) {\n        throw new Error(\"invalid request\");\n      }\n\n      if (!this._rtcDataChannel) {\n        throw new Error(\"remote controller data channel is closed\");\n      }\n\n      let message = {\n        id: this._requestCounter++,\n        request: request\n      };\n\n      this._rtcDataChannel.send(JSON.stringify(message));\n\n      return message.id;\n    } catch (ex) {\n      this.dispatchEvent(new ErrorEvent(\"error\", {\n        message: `cannot send control message over session ${this._consumerSession.sessionId} remote controller`,\n        error: ex\n      }));\n      return -1;\n    }\n  }\n\n  /**\n   * Closes the remote controller channel.<br>\n   * It immediately shuts down the underlying WebRTC data channel connected to a remote GStreamer webrtcsink\n   * producer and detaches any video element that may be used to relay mouse and keyboard events.\n   */\n  close() {\n    this.attachVideoElement(null);\n\n    const rtcDataChannel = this._rtcDataChannel;\n    this._rtcDataChannel = null;\n\n    if (rtcDataChannel) {\n      rtcDataChannel.close();\n      this.dispatchEvent(new Event(\"closed\"));\n    }\n  }\n\n  _sendGstNavigationEvent(data) {\n    let request = {\n      type: \"navigationEvent\",\n      event: data\n    };\n    this.sendControlRequest(request);\n  }\n\n  _computeVideoMousePosition(event) {\n    const mousePos = { x: 0, y: 0 };\n    if (!this._videoElement || (this._videoElement.videoWidth <= 0) || (this._videoElement.videoHeight <= 0)) {\n      return mousePos;\n    }\n\n    const padding = {\n      left: parseFloat(this._videoElementComputedStyle.paddingLeft),\n      right: parseFloat(this._videoElementComputedStyle.paddingRight),\n      top: parseFloat(this._videoElementComputedStyle.paddingTop),\n      bottom: parseFloat(this._videoElementComputedStyle.paddingBottom)\n    };\n\n    if ((\"offsetX\" in event) && (\"offsetY\" in event)) {\n      mousePos.x = event.offsetX - padding.left;\n      mousePos.y = event.offsetY - padding.top;\n    } else {\n      const clientRect = this._videoElement.getBoundingClientRect();\n      const border = {\n        left: parseFloat(this._videoElementComputedStyle.borderLeftWidth),\n        top: parseFloat(this._videoElementComputedStyle.borderTopWidth)\n      };\n      mousePos.x = event.clientX - clientRect.left - border.left - padding.left;\n      mousePos.y = event.clientY - clientRect.top - border.top - padding.top;\n    }\n\n    const videoOffset = {\n      x: this._videoElement.clientWidth - (padding.left + padding.right),\n      y: this._videoElement.clientHeight - (padding.top + padding.bottom)\n    };\n\n    const ratio = Math.min(videoOffset.x / this._videoElement.videoWidth, videoOffset.y / this._videoElement.videoHeight);\n    videoOffset.x = Math.max(0.5 * (videoOffset.x - this._videoElement.videoWidth * ratio), 0);\n    videoOffset.y = Math.max(0.5 * (videoOffset.y - this._videoElement.videoHeight * ratio), 0);\n\n    const invRatio = (ratio !== 0) ? (1 / ratio) : 0;\n    mousePos.x = (mousePos.x - videoOffset.x) * invRatio;\n    mousePos.y = (mousePos.y - videoOffset.y) * invRatio;\n\n    mousePos.x = Math.min(Math.max(mousePos.x, 0), this._videoElement.videoWidth);\n    mousePos.y = Math.min(Math.max(mousePos.y, 0), this._videoElement.videoHeight);\n\n    return mousePos;\n  }\n\n  handleEvent(event) {\n    if (!this._videoElement) {\n      return;\n    }\n\n    switch (event.type) {\n    case \"wheel\":\n      event.preventDefault();\n      {\n        const mousePos = this._computeVideoMousePosition(event);\n        this._sendGstNavigationEvent({\n          event: \"MouseScroll\",\n          x: mousePos.x,\n          y: mousePos.y,\n          delta_x: -event.deltaX, // eslint-disable-line camelcase\n          delta_y: -event.deltaY, // eslint-disable-line camelcase\n          modifier_state: getModifiers(event) // eslint-disable-line camelcase\n        });\n      }\n      break;\n\n    case \"contextmenu\":\n      event.preventDefault();\n      break;\n\n    case \"mousemove\":\n    case \"mousedown\":\n    case \"mouseup\":\n      event.preventDefault();\n      {\n        const mousePos = this._computeVideoMousePosition(event);\n        const data = {\n          event: mouseEventsNames[event.type],\n          x: mousePos.x,\n          y: mousePos.y,\n          modifier_state: getModifiers(event) // eslint-disable-line camelcase\n        };\n\n        if (event.type !== \"mousemove\") {\n          data.button = event.button + 1;\n\n          if ((event.type === \"mousedown\") && (event.button === 0)) {\n            this._videoElement.focus();\n          }\n        }\n\n        this._sendGstNavigationEvent(data);\n      }\n      break;\n\n    case \"touchstart\":\n    case \"touchend\":\n    case \"touchmove\":\n    case \"touchcancel\":\n      for (const touch of event.changedTouches) {\n        const mousePos = this._computeVideoMousePosition(touch);\n        const data = {\n          event: touchEventsNames[event.type],\n          identifier: touch.identifier,\n          x: mousePos.x,\n          y: mousePos.y,\n          modifier_state: getModifiers(event) // eslint-disable-line camelcase\n        };\n\n        if ((\"force\" in touch) && ((event.type === \"touchstart\") || (event.type === \"touchmove\"))) {\n          data.pressure = touch.force;\n        }\n\n        this._sendGstNavigationEvent(data);\n      }\n\n      if (event.timeStamp > this._lastTouchEventTimestamp) {\n        this._lastTouchEventTimestamp = event.timeStamp;\n        this._sendGstNavigationEvent({\n          event: \"TouchFrame\",\n          modifier_state: getModifiers(event) // eslint-disable-line camelcase\n        });\n      }\n      break;\n    case \"keyup\":\n    case \"keydown\":\n      event.preventDefault();\n      {\n        const data = {\n          event: keyboardEventsNames[event.type],\n          key: getKeysymString(event.key, event.code),\n          modifier_state: getModifiers(event) // eslint-disable-line camelcase\n        };\n        this._sendGstNavigationEvent(data);\n      }\n      break;\n    }\n  }\n}\n\nexport default RemoteController;\n","/*\n * gstwebrtc-api\n *\n * Copyright (C) 2022 Igalia S.L. <info@igalia.com>\n *   Author: Loc Le Page <llepage@igalia.com>\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\nimport WebRTCSession from \"./webrtc-session.js\";\nimport SessionState from \"./session-state.js\";\nimport RemoteController from \"./remote-controller.js\";\n\n/**\n * Event name: \"streamsChanged\".<br>\n * Triggered when the underlying media streams of a {@link ConsumerSession} change.\n * @event GstWebRTCAPI#StreamsChangedEvent\n * @type {Event}\n * @see ConsumerSession#streams\n */\n/**\n * Event name: \"remoteControllerChanged\".<br>\n * Triggered when the underlying remote controller of a {@link ConsumerSession} changes.\n * @event GstWebRTCAPI#RemoteControllerChangedEvent\n * @type {Event}\n * @see ConsumerSession#remoteController\n */\n\n/**\n * @class ConsumerSession\n * @hideconstructor\n * @classdesc Consumer session managing a peer-to-peer WebRTC channel between a remote producer and this client\n * instance.\n * <p>Call {@link GstWebRTCAPI#createConsumerSession} to create a ConsumerSession instance.</p>\n * @extends {WebRTCSession}\n * @fires {@link GstWebRTCAPI#event:StreamsChangedEvent}\n * @fires {@link GstWebRTCAPI#event:RemoteControllerChangedEvent}\n */\nclass ConsumerSession extends WebRTCSession {\n  constructor(peerId, comChannel, offerOptions) {\n    super(peerId, comChannel);\n    this._streams = [];\n    this._remoteController = null;\n    this._pendingCandidates = [];\n    this._mungeStereoHack = false;\n\n    this._offerOptions = offerOptions;\n\n    this.addEventListener(\"closed\", () => {\n      this._streams = [];\n      this._pendingCandidates = [];\n\n      if (this._remoteController) {\n        this._remoteController.close();\n      }\n    });\n  }\n\n  /**\n   * Defines whether the SDP should be munged in order to enable stereo with chrome.\n   * @method\n   * @param {boolean} enable - Enable or disable the hack, default is false\n   */\n  set mungeStereoHack(enable) {\n    if (typeof (enable) !== \"boolean\") { return; }\n\n    this._mungeStereoHack = enable;\n  }\n\n  /**\n   * The array of remote media streams consumed locally through this WebRTC channel.\n   * @type {MediaStream[]}\n   * @readonly\n   */\n  get streams() {\n    return this._streams;\n  }\n\n  /**\n   * The remote controller associated with this WebRTC consumer session. Value may be null if consumer session\n   * has no remote controller.\n   * @type {RemoteController}\n   * @readonly\n   */\n  get remoteController() {\n    return this._remoteController;\n  }\n\n  /**\n   * Connects the consumer session to its remote producer.<br>\n   * This method must be called after creating the consumer session in order to start receiving the remote streams.\n   * It registers this consumer session to the signaling server and gets ready to receive audio/video streams.\n   * <p>Even on success, streaming can fail later if any error occurs during or after connection. In order to know\n   * the effective streaming state, you should be listening to the [error]{@link GstWebRTCAPI#event:ErrorEvent},\n   * [stateChanged]{@link GstWebRTCAPI#event:StateChangedEvent} and/or [closed]{@link GstWebRTCAPI#event:ClosedEvent}\n   * events.</p>\n   * @returns {boolean} true in case of success (may fail later during or after connection) or false in case of\n   * immediate error (wrong session state or no connection to the signaling server).\n   */\n  connect() {\n    if (!this._comChannel || (this._state === SessionState.closed)) {\n      return false;\n    }\n\n    if (this._state !== SessionState.idle) {\n      return true;\n    }\n\n    if (this._offerOptions) {\n      this.ensurePeerConnection();\n\n      this._rtcPeerConnection.createDataChannel(\"control\");\n\n      this._rtcPeerConnection.createOffer(this._offerOptions).then((desc) => {\n        if (this._rtcPeerConnection && desc) {\n          return this._rtcPeerConnection.setLocalDescription(desc);\n        } else {\n          throw new Error(\"cannot send local offer to WebRTC peer\");\n        }\n      }).then(() => {\n        if (this._rtcPeerConnection && this._comChannel) {\n          const msg = {\n            type: \"startSession\",\n            peerId: this._peerId,\n            offer: this._rtcPeerConnection.localDescription.toJSON().sdp\n          };\n          if (!this._comChannel.send(msg)) {\n            throw new Error(\"cannot send startSession message to signaling server\");\n          }\n          this._state = SessionState.connecting;\n          this.dispatchEvent(new Event(\"stateChanged\"));\n        }\n      }).catch((ex) => {\n        if (this._state !== SessionState.closed) {\n          this.dispatchEvent(new ErrorEvent(\"error\", {\n            message: \"an unrecoverable error occurred during SDP handshake\",\n            error: ex\n          }));\n\n          this.close();\n        }\n      });\n    } else {\n      const msg = {\n        type: \"startSession\",\n        peerId: this._peerId\n      };\n      if (!this._comChannel.send(msg)) {\n        this.dispatchEvent(new ErrorEvent(\"error\", {\n          message: \"cannot connect consumer session\",\n          error: new Error(\"cannot send startSession message to signaling server\")\n        }));\n\n        this.close();\n        return false;\n      }\n\n      this._state = SessionState.connecting;\n      this.dispatchEvent(new Event(\"stateChanged\"));\n    }\n\n    return true;\n  }\n\n  onSessionStarted(peerId, sessionId) {\n    if ((this._peerId === peerId) && (this._state === SessionState.connecting) && !this._sessionId) {\n      console.log(\"Session started\", this._sessionId);\n      this._sessionId = sessionId;\n\n      for (const candidate of this._pendingCandidates) {\n        console.log(\"Sending delayed ICE with session id\", this._sessionId);\n        this._comChannel.send({\n          type: \"peer\",\n          sessionId: this._sessionId,\n          ice: candidate.toJSON()\n        });\n      }\n\n      this._pendingCandidates = [];\n    }\n  }\n\n  ensurePeerConnection() {\n    if (!this._rtcPeerConnection) {\n      const connection = new RTCPeerConnection(this._comChannel.webrtcConfig);\n      this._rtcPeerConnection = connection;\n\n      connection.ontrack = (event) => {\n        if ((this._rtcPeerConnection === connection) && event.streams && (event.streams.length > 0)) {\n          if (this._state === SessionState.connecting) {\n            this._state = SessionState.streaming;\n            this.dispatchEvent(new Event(\"stateChanged\"));\n          }\n\n          let streamsChanged = false;\n          for (const stream of event.streams) {\n            if (!this._streams.includes(stream)) {\n              this._streams.push(stream);\n              streamsChanged = true;\n            }\n          }\n\n          if (streamsChanged) {\n            this.dispatchEvent(new Event(\"streamsChanged\"));\n          }\n        }\n      };\n\n      connection.ondatachannel = (event) => {\n        const rtcDataChannel = event.channel;\n        if (rtcDataChannel && (rtcDataChannel.label === \"control\")) {\n          if (this._remoteController) {\n            const previousController = this._remoteController;\n            this._remoteController = null;\n            previousController.close();\n          }\n\n          const remoteController = new RemoteController(rtcDataChannel, this);\n          this._remoteController = remoteController;\n          this.dispatchEvent(new Event(\"remoteControllerChanged\"));\n\n          remoteController.addEventListener(\"closed\", () => {\n            if (this._remoteController === remoteController) {\n              this._remoteController = null;\n              this.dispatchEvent(new Event(\"remoteControllerChanged\"));\n            }\n          });\n        }\n      };\n\n      connection.onicecandidate = (event) => {\n        if ((this._rtcPeerConnection === connection) && event.candidate && this._comChannel) {\n          if (this._sessionId) {\n            console.log(\"Sending ICE with session id\", this._sessionId);\n            this._comChannel.send({\n              type: \"peer\",\n              sessionId: this._sessionId,\n              ice: event.candidate.toJSON()\n            });\n          } else {\n            this._pendingCandidates.push(event.candidate);\n          }\n        }\n      };\n\n      this.dispatchEvent(new Event(\"rtcPeerConnectionChanged\"));\n    }\n  }\n\n  // Work around Chrome not handling stereo Opus correctly.\n  // See\n  //   https://chromium.googlesource.com/external/webrtc/+/194e3bcc53ffa3e98045934377726cb25d7579d2/webrtc/media/engine/webrtcvoiceengine.cc#302\n  //   https://bugs.chromium.org/p/webrtc/issues/detail?id=8133\n  //\n  // Technically it's against the spec to modify the SDP\n  // but there's no other API for this and this seems to\n  // be the only possible workaround at this time.\n  mungeStereo(offerSdp, answerSdp) {\n    const stereoRegexp = /a=fmtp:.* sprop-stereo/g;\n    let stereoPayloads = new Set();\n    for (const m of offerSdp.matchAll(stereoRegexp)) {\n      const payloadMatch = m[0].match(/a=fmtp:(\\d+) .*/);\n      if (payloadMatch) {\n        stereoPayloads.add(payloadMatch[1]);\n      }\n    }\n\n    for (const payload of stereoPayloads) {\n      const isStereoRegexp = new RegExp(\"a=fmtp:\" + payload + \".*stereo\");\n      const answerIsStereo = answerSdp.match(isStereoRegexp);\n\n      if (!answerIsStereo) {\n        answerSdp = answerSdp.replaceAll(\"a=fmtp:\" + payload, \"a=fmtp:\" + payload + \" stereo=1;\");\n      }\n    }\n\n    return answerSdp;\n  }\n\n  onSessionPeerMessage(msg) {\n    if ((this._state === SessionState.closed) || !this._comChannel || !this._sessionId) {\n      return;\n    }\n\n    this.ensurePeerConnection();\n\n    if (msg.sdp) {\n      if (this._offerOptions) {\n        this._rtcPeerConnection.setRemoteDescription(msg.sdp).then(() => {\n          console.log(\"done\");\n        }).catch((ex) => {\n          if (this._state !== SessionState.closed) {\n            this.dispatchEvent(new ErrorEvent(\"error\", {\n              message: \"an unrecoverable error occurred during SDP handshake\",\n              error: ex\n            }));\n\n            this.close();\n          }\n        });\n      } else {\n        this._rtcPeerConnection.setRemoteDescription(msg.sdp).then(() => {\n          if (this._rtcPeerConnection) {\n            return this._rtcPeerConnection.createAnswer();\n          } else {\n            return null;\n          }\n        }).then((desc) => {\n          if (this._rtcPeerConnection && desc) {\n            if (this._mungeStereoHack) {\n              desc.sdp = this.mungeStereo(msg.sdp.sdp, desc.sdp);\n            }\n\n            return this._rtcPeerConnection.setLocalDescription(desc);\n          } else {\n            return null;\n          }\n        }).then(() => {\n          if (this._rtcPeerConnection && this._comChannel) {\n            console.log(\"Sending SDP with session id\", this._sessionId);\n            const sdp = {\n              type: \"peer\",\n              sessionId: this._sessionId,\n              sdp: this._rtcPeerConnection.localDescription.toJSON()\n            };\n            if (!this._comChannel.send(sdp)) {\n              throw new Error(\"cannot send local SDP configuration to WebRTC peer\");\n            }\n          }\n        }).catch((ex) => {\n          if (this._state !== SessionState.closed) {\n            this.dispatchEvent(new ErrorEvent(\"error\", {\n              message: \"an unrecoverable error occurred during SDP handshake\",\n              error: ex\n            }));\n\n            this.close();\n          }\n        });\n      }\n    } else if (msg.ice) {\n      const candidate = msg.ice.candidate ? new RTCIceCandidate(msg.ice) : null;\n      this._rtcPeerConnection.addIceCandidate(candidate).catch((ex) => {\n        if (this._state !== SessionState.closed) {\n          this.dispatchEvent(new ErrorEvent(\"error\", {\n            message: \"an unrecoverable error occurred during ICE handshake\",\n            error: ex\n          }));\n\n          this.close();\n        }\n      });\n    } else {\n      throw new Error(`invalid empty peer message received from consumer session ${this._sessionId}`);\n    }\n  }\n}\n\nexport default ConsumerSession;\n","/*\n * gstwebrtc-api\n *\n * Copyright (C) 2022 Igalia S.L. <info@igalia.com>\n *   Author: Loc Le Page <llepage@igalia.com>\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\nimport WebRTCSession from \"./webrtc-session.js\";\nimport SessionState from \"./session-state.js\";\n\n/**\n * @class ClientSession\n * @hideconstructor\n * @classdesc Client session representing a link between a remote consumer and a local producer session.\n * @extends {WebRTCSession}\n */\nclass ClientSession extends WebRTCSession {\n  constructor(peerId, sessionId, comChannel, stream) {\n    super(peerId, comChannel);\n    this._sessionId = sessionId;\n    this._state = SessionState.streaming;\n\n    const connection = new RTCPeerConnection(this._comChannel.webrtcConfig);\n    this._rtcPeerConnection = connection;\n\n    for (const track of stream.getTracks()) {\n      connection.addTrack(track, stream);\n    }\n\n    connection.onicecandidate = (event) => {\n      if ((this._rtcPeerConnection === connection) && event.candidate && this._comChannel) {\n        this._comChannel.send({\n          type: \"peer\",\n          sessionId: this._sessionId,\n          ice: event.candidate.toJSON()\n        });\n      }\n    };\n\n    this.dispatchEvent(new Event(\"rtcPeerConnectionChanged\"));\n\n    connection.setLocalDescription().then(() => {\n      if ((this._rtcPeerConnection === connection) && this._comChannel) {\n        const sdp = {\n          type: \"peer\",\n          sessionId: this._sessionId,\n          sdp: this._rtcPeerConnection.localDescription.toJSON()\n        };\n        if (!this._comChannel.send(sdp)) {\n          throw new Error(\"cannot send local SDP configuration to WebRTC peer\");\n        }\n      }\n    }).catch((ex) => {\n      if (this._state !== SessionState.closed) {\n        this.dispatchEvent(new ErrorEvent(\"error\", {\n          message: \"an unrecoverable error occurred during SDP handshake\",\n          error: ex\n        }));\n\n        this.close();\n      }\n    });\n  }\n\n  onSessionPeerMessage(msg) {\n    if ((this._state === SessionState.closed) || !this._rtcPeerConnection) {\n      return;\n    }\n\n    if (msg.sdp) {\n      this._rtcPeerConnection.setRemoteDescription(msg.sdp).catch((ex) => {\n        if (this._state !== SessionState.closed) {\n          this.dispatchEvent(new ErrorEvent(\"error\", {\n            message: \"an unrecoverable error occurred during SDP handshake\",\n            error: ex\n          }));\n\n          this.close();\n        }\n      });\n    } else if (msg.ice) {\n      const candidate = new RTCIceCandidate(msg.ice);\n      this._rtcPeerConnection.addIceCandidate(candidate).catch((ex) => {\n        if (this._state !== SessionState.closed) {\n          this.dispatchEvent(new ErrorEvent(\"error\", {\n            message: \"an unrecoverable error occurred during ICE handshake\",\n            error: ex\n          }));\n\n          this.close();\n        }\n      });\n    } else {\n      throw new Error(`invalid empty peer message received from producer's client session ${this._peerId}`);\n    }\n  }\n}\n\n/**\n * Event name: \"clientConsumerAdded\".<br>\n * Triggered when a remote consumer peer connects to a local {@link ProducerSession}.\n * @event GstWebRTCAPI#ClientConsumerAddedEvent\n * @type {CustomEvent}\n * @property {ClientSession} detail - The WebRTC session associated with the added consumer peer.\n * @see ProducerSession\n */\n/**\n * Event name: \"clientConsumerRemoved\".<br>\n * Triggered when a remote consumer peer disconnects from a local {@link ProducerSession}.\n * @event GstWebRTCAPI#ClientConsumerRemovedEvent\n * @type {CustomEvent}\n * @property {ClientSession} detail - The WebRTC session associated with the removed consumer peer.\n * @see ProducerSession\n */\n\n/**\n * @class ProducerSession\n * @hideconstructor\n * @classdesc Producer session managing the streaming out of a local {@link MediaStream}.<br>\n * It manages all underlying WebRTC connections to each peer client consuming the stream.\n * <p>Call {@link GstWebRTCAPI#createProducerSession} to create a ProducerSession instance.</p>\n * @extends {EventTarget}\n * @fires {@link GstWebRTCAPI#event:ErrorEvent}\n * @fires {@link GstWebRTCAPI#event:StateChangedEvent}\n * @fires {@link GstWebRTCAPI#event:ClosedEvent}\n * @fires {@link GstWebRTCAPI#event:ClientConsumerAddedEvent}\n * @fires {@link GstWebRTCAPI#event:ClientConsumerRemovedEvent}\n */\nclass ProducerSession extends EventTarget {\n  constructor(comChannel, stream, consumerId) {\n    super();\n\n    this._comChannel = comChannel;\n    this._stream = stream;\n    this._state = SessionState.idle;\n    this._clientSessions = {};\n    this._consumerId = consumerId;\n  }\n\n  /**\n   * The local stream produced out by this session.\n   * @type {MediaStream}\n   * @readonly\n   */\n  get stream() {\n    return this._stream;\n  }\n\n  /**\n   * The current producer session state.\n   * @type {SessionState}\n   * @readonly\n   */\n  get state() {\n    return this._state;\n  }\n\n  /**\n   * Starts the producer session.<br>\n   * This method must be called after creating the producer session in order to start streaming. It registers this\n   * producer session to the signaling server and gets ready to serve peer requests from consumers.\n   * <p>Even on success, streaming can fail later if any error occurs during or after connection. In order to know\n   * the effective streaming state, you should be listening to the [error]{@link GstWebRTCAPI#event:ErrorEvent},\n   * [stateChanged]{@link GstWebRTCAPI#event:StateChangedEvent} and/or [closed]{@link GstWebRTCAPI#event:ClosedEvent}\n   * events.</p>\n   * @returns {boolean} true in case of success (may fail later during or after connection) or false in case of\n   * immediate error (wrong session state or no connection to the signaling server).\n   */\n  start() {\n    if (!this._comChannel || (this._state === SessionState.closed)) {\n      return false;\n    }\n\n    if (this._state !== SessionState.idle) {\n      return true;\n    }\n\n    const msg = {\n      type: \"setPeerStatus\",\n      roles: [\"listener\", \"producer\"],\n      meta: this._comChannel.meta\n    };\n    if (!this._comChannel.send(msg)) {\n      this.dispatchEvent(new ErrorEvent(\"error\", {\n        message: \"cannot start producer session\",\n        error: new Error(\"cannot register producer to signaling server\")\n      }));\n\n      this.close();\n      return false;\n    }\n\n    this._state = SessionState.connecting;\n    this.dispatchEvent(new Event(\"stateChanged\"));\n    return true;\n  }\n\n  /**\n   * Terminates the producer session.<br>\n   * It immediately disconnects all peer consumers attached to this producer session and unregisters the producer\n   * from the signaling server.\n   */\n  close() {\n    if (this._state !== SessionState.closed) {\n      for (const track of this._stream.getTracks()) {\n        track.stop();\n      }\n\n      if ((this._state !== SessionState.idle) && this._comChannel) {\n        this._comChannel.send({\n          type: \"setPeerStatus\",\n          roles: [\"listener\"],\n          meta: this._comChannel.meta\n        });\n      }\n\n      this._state = SessionState.closed;\n      this.dispatchEvent(new Event(\"stateChanged\"));\n\n      this._comChannel = null;\n      this._stream = null;\n\n      for (const clientSession of Object.values(this._clientSessions)) {\n        clientSession.close();\n      }\n      this._clientSessions = {};\n\n      this.dispatchEvent(new Event(\"closed\"));\n    }\n  }\n\n  onProducerRegistered() {\n    if (this._state === SessionState.connecting) {\n      this._state = SessionState.streaming;\n      this.dispatchEvent(new Event(\"stateChanged\"));\n    }\n\n    if (this._consumerId) {\n      const msg = {\n        type: \"startSession\",\n        peerId: this._consumerId\n      };\n      if (!this._comChannel.send(msg)) {\n        this.dispatchEvent(new ErrorEvent(\"error\", {\n          message: \"cannot send session request to specified consumer\",\n          error: new Error(\"cannot send startSession message to signaling server\")\n        }));\n\n        this.close();\n      }\n    }\n  }\n\n  onStartSessionMessage(msg) {\n    if (this._comChannel && this._stream && !(msg.sessionId in this._clientSessions)) {\n      const session = new ClientSession(msg.peerId, msg.sessionId, this._comChannel, this._stream);\n      this._clientSessions[msg.sessionId] = session;\n\n      session.addEventListener(\"closed\", (event) => {\n        const sessionId = event.target.sessionId;\n        if ((sessionId in this._clientSessions) && (this._clientSessions[sessionId] === session)) {\n          delete this._clientSessions[sessionId];\n          this.dispatchEvent(new CustomEvent(\"clientConsumerRemoved\", { detail: session }));\n        }\n      });\n\n      session.addEventListener(\"error\", (event) => {\n        this.dispatchEvent(new ErrorEvent(\"error\", {\n          message: `error from client consumer ${event.target.peerId}: ${event.message}`,\n          error: event.error\n        }));\n      });\n\n      this.dispatchEvent(new CustomEvent(\"clientConsumerAdded\", { detail: session }));\n    }\n  }\n\n  onEndSessionMessage(msg) {\n    if (msg.sessionId in this._clientSessions) {\n      this._clientSessions[msg.sessionId].close();\n    }\n  }\n\n  onSessionPeerMessage(msg) {\n    if (msg.sessionId in this._clientSessions) {\n      this._clientSessions[msg.sessionId].onSessionPeerMessage(msg);\n    }\n  }\n}\n\nexport default ProducerSession;\n","/*\n * gstwebrtc-api\n *\n * Copyright (C) 2022 Igalia S.L. <info@igalia.com>\n *   Author: Loc Le Page <llepage@igalia.com>\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\nimport ConsumerSession from \"./consumer-session.js\";\nimport ProducerSession from \"./producer-session.js\";\n\nconst SignallingServerMessageType = Object.freeze({\n  welcome: \"welcome\",\n  peerStatusChanged: \"peerStatusChanged\",\n  list: \"list\",\n  listConsumers: \"listConsumers\",\n  sessionStarted: \"sessionStarted\",\n  peer: \"peer\",\n  startSession: \"startSession\",\n  endSession: \"endSession\",\n  error: \"error\"\n});\n\nfunction normalizePeer(peer, excludedId) {\n  if (!peer || (typeof (peer) !== \"object\")) {\n    return null;\n  }\n\n  const normalizedPeer = {\n    id: \"\",\n    meta: {}\n  };\n\n  if (peer.id && (typeof (peer.id) === \"string\")) {\n    normalizedPeer.id = peer.id;\n  } else if (peer.peerId && (typeof (peer.peerId) === \"string\")) {\n    normalizedPeer.id = peer.peerId;\n  } else {\n    return null;\n  }\n\n  if (normalizedPeer.id === excludedId) {\n    return null;\n  }\n\n  if (peer.meta && (typeof (peer.meta) === \"object\")) {\n    normalizedPeer.meta = peer.meta;\n  }\n\n  Object.freeze(normalizedPeer.meta);\n  return Object.freeze(normalizedPeer);\n}\n\nclass ComChannel extends EventTarget {\n  constructor(url, meta, webrtcConfig) {\n    super();\n\n    this._meta = meta;\n    this._webrtcConfig = webrtcConfig;\n    this._ws = new WebSocket(url);\n    this._ready = false;\n    this._channelId = \"\";\n    this._producerSession = null;\n    this._consumerSessions = {};\n    this._peers = {};\n\n    this._ws.onerror = (event) => {\n      this.dispatchEvent(new ErrorEvent(\"error\", {\n        message: event.message || \"WebSocket error\",\n        error: event.error || new Error(\n          this._ready ? \"transportation error\" : \"cannot connect to signaling server\")\n      }));\n      this.close();\n    };\n\n    this._ws.onclose = () => {\n      this._ready = false;\n      this._channelId = \"\";\n      this._ws = null;\n\n      this.closeAllConsumerSessions();\n\n      if (this._producerSession) {\n        this._producerSession.close();\n        this._producerSession = null;\n      }\n\n      this.dispatchEvent(new Event(\"closed\"));\n    };\n\n    this._ws.onmessage = (event) => {\n      try {\n        const msg = JSON.parse(event.data);\n        if (msg && (typeof (msg) === \"object\")) {\n          switch (msg.type) {\n\n          case SignallingServerMessageType.welcome:\n            this._channelId = msg.peerId;\n            try {\n              this._ws.send(JSON.stringify({\n                type: \"setPeerStatus\",\n                roles: [\"listener\"],\n                meta: meta\n              }));\n            } catch (ex) {\n              this.dispatchEvent(new ErrorEvent(\"error\", {\n                message: \"cannot initialize connection to signaling server\",\n                error: ex\n              }));\n              this.close();\n            }\n            break;\n\n          case SignallingServerMessageType.peerStatusChanged: {\n            if (msg.peerId === this._channelId) {\n              if (!this._ready && msg.roles.includes(\"listener\")) {\n                this._ready = true;\n                this.dispatchEvent(new Event(\"ready\"));\n                this.send({ type: \"list\" });\n                this.send({ type: \"listConsumers\"});\n              }\n\n              if (this._producerSession && msg.roles.includes(\"producer\")) {\n                this._producerSession.onProducerRegistered();\n              }\n\n              break;\n            }\n\n            const peer = normalizePeer(msg, this._channelId);\n            if (!peer) {\n              break;\n            }\n\n            const oldRoles = this._peers[msg.peerId] || [];\n            this._peers[msg.peerId] = msg.roles;\n            for (const role of [\"producer\", \"consumer\"]) {\n              if (!oldRoles.includes(role) && msg.roles.includes(role)) {\n                this.dispatchEvent(new CustomEvent(\"peerAdded\", { detail: { peer, role } }));\n              } else if (oldRoles.includes(role) && !msg.roles.includes(role)) {\n                this.dispatchEvent(new CustomEvent(\"peerRemoved\", { detail: { peerId: msg.peerId, role } }));\n              }\n            }\n            break;\n          }\n\n          case SignallingServerMessageType.list: {\n            this.clearPeers(\"producer\");\n            this.addPeers(msg.producers, \"producer\");\n            break;\n          }\n\n          case SignallingServerMessageType.listConsumers: {\n            this.clearPeers(\"consumer\");\n            this.addPeers(msg.consumers, \"consumer\");\n            break;\n          }\n\n          case SignallingServerMessageType.sessionStarted:\n            {\n              const session = this.getConsumerSession(msg.peerId);\n              if (session) {\n                delete this._consumerSessions[msg.peerId];\n\n                session.onSessionStarted(msg.peerId, msg.sessionId);\n                if (session.sessionId && !(session.sessionId in this._consumerSessions)) {\n                  this._consumerSessions[session.sessionId] = session;\n                } else {\n                  session.close();\n                }\n              }\n            }\n            break;\n\n          case SignallingServerMessageType.peer:\n            {\n              const session = this.getConsumerSession(msg.sessionId);\n              if (session) {\n                session.onSessionPeerMessage(msg);\n              } else if (this._producerSession) {\n                this._producerSession.onSessionPeerMessage(msg);\n              }\n            }\n            break;\n\n          case SignallingServerMessageType.startSession:\n            if (this._producerSession) {\n              this._producerSession.onStartSessionMessage(msg);\n            }\n            break;\n\n          case SignallingServerMessageType.endSession:\n            {\n              const session = this.getConsumerSession(msg.sessionId);\n              if (session) {\n                session.close();\n              } else if (this._producerSession) {\n                this._producerSession.onEndSessionMessage(msg);\n              }\n            }\n            break;\n\n          case SignallingServerMessageType.error:\n            this.dispatchEvent(new ErrorEvent(\"error\", {\n              message: \"error received from signaling server\",\n              error: new Error(msg.details)\n            }));\n            break;\n\n          default:\n            throw new Error(`unknown message type: \"${msg.type}\"`);\n          }\n        }\n      } catch (ex) {\n        this.dispatchEvent(new ErrorEvent(\"error\", {\n          message: \"cannot parse incoming message from signaling server\",\n          error: ex\n        }));\n      }\n    };\n  }\n\n  get meta() {\n    return this._meta;\n  }\n\n  get webrtcConfig() {\n    return this._webrtcConfig;\n  }\n\n  get ready() {\n    return this._ready;\n  }\n\n  get channelId() {\n    return this._channelId;\n  }\n\n  get producerSession() {\n    return this._producerSession;\n  }\n\n  createProducerSession(stream, consumerId) {\n    if (!this._ready || !(stream instanceof MediaStream)) {\n      return null;\n    }\n\n    if (this._producerSession) {\n      if (this._producerSession.stream === stream) {\n        return this._producerSession;\n      } else {\n        return null;\n      }\n    }\n\n    const session = new ProducerSession(this, stream, consumerId);\n    this._producerSession = session;\n\n    session.addEventListener(\"closed\", () => {\n      if (this._producerSession === session) {\n        this._producerSession = null;\n      }\n    });\n\n    return session;\n  }\n\n  createConsumerSession(producerId, offerOptions) {\n    if (!this._ready || !producerId || (typeof (producerId) !== \"string\")) {\n      return null;\n    }\n\n    if (offerOptions && (typeof(offerOptions) !== \"object\")) {\n      offerOptions = undefined;\n    }\n\n    if (producerId in this._consumerSessions) {\n      return this._consumerSessions[producerId];\n    }\n\n    for (const session of Object.values(this._consumerSessions)) {\n      if (session.peerId === producerId) {\n        return session;\n      }\n    }\n\n    const session = new ConsumerSession(producerId, this, offerOptions);\n    this._consumerSessions[producerId] = session;\n\n    session.addEventListener(\"closed\", (event) => {\n      let sessionId = event.target.sessionId;\n      if (!sessionId) {\n        sessionId = event.target.peerId;\n      }\n\n      if ((sessionId in this._consumerSessions) && (this._consumerSessions[sessionId] === session)) {\n        delete this._consumerSessions[sessionId];\n      }\n    });\n\n    return session;\n  }\n\n  getConsumerSession(sessionId) {\n    if (sessionId in this._consumerSessions) {\n      return this._consumerSessions[sessionId];\n    } else {\n      return null;\n    }\n  }\n\n  closeAllConsumerSessions() {\n    for (const session of Object.values(this._consumerSessions)) {\n      session.close();\n    }\n\n    this._consumerSessions = {};\n  }\n\n  send(data) {\n    if (this._ready && data && (typeof (data) === \"object\")) {\n      try {\n        this._ws.send(JSON.stringify(data));\n        return true;\n      } catch (ex) {\n        this.dispatchEvent(new ErrorEvent(\"error\", {\n          message: \"cannot send message to signaling server\",\n          error: ex\n        }));\n      }\n    }\n\n    return false;\n  }\n\n  close() {\n    if (this._ws) {\n      this._ready = false;\n      this._channelId = \"\";\n      this._ws.close();\n\n      this.closeAllConsumerSessions();\n\n      if (this._producerSession) {\n        this._producerSession.close();\n        this._producerSession = null;\n      }\n    }\n  }\n\n  clearPeers(role) {\n    for (const peerId in this._peers) {\n      if (this._peers[peerId].includes(role)) {\n        delete this._peers[peerId];\n        this.dispatchEvent(new CustomEvent(\"peerRemoved\", { detail: { peerId, role } }));\n      }\n    }\n  }\n\n  addPeers(items, role) {\n    items.forEach(item => {\n      const peer = normalizePeer(item, this._channelId);\n      if (peer) {\n        this._peers[peer.id] = [role];\n        this.dispatchEvent(new CustomEvent(\"peerAdded\", { detail: { peer, role } }));\n      }\n    });\n  };\n}\n\nexport default ComChannel;\n","/*\n * gstwebrtc-api\n *\n * Copyright (C) 2022 Igalia S.L. <info@igalia.com>\n *   Author: Loc Le Page <llepage@igalia.com>\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\nimport defaultConfig from \"./config.js\";\nimport ComChannel from \"./com-channel.js\";\nimport SessionState from \"./session-state.js\";\n\n/** @import ConsumerSession from \"./consumer-session.js\"; */\n/** @import ProducerSession from \"./producer-session.js\"; */\n/** @import GstWebRTCConfig from \"./config.js\"; */\n/** @import RTCOfferOptions from \"typescript/lib/lib.dom.js\"; */\n\nclass GstWebRTCAPI {\n  /**\n   * @class GstWebRTCAPI\n   * @classdesc The API entry point that manages a WebRTC.\n   * @constructor\n   * @param {GstWebRTCConfig} [userConfig] - The user configuration.<br>\n   * Only the parameters different from the default ones need to be provided.\n   */\n  constructor(userConfig) {\n    this._channel = null;\n    this._producers = {};\n    this._consumers = {};\n    this._connectionListeners = [];\n    this._peerListeners = [];\n\n    const config = Object.assign({}, defaultConfig);\n    if (userConfig && (typeof (userConfig) === \"object\")) {\n      Object.assign(config, userConfig);\n    }\n\n    if (typeof (config.meta) !== \"object\") {\n      config.meta = null;\n    }\n\n    this._config = config;\n    this.connectChannel();\n  }\n\n  /**\n   * @interface ConnectionListener\n   */\n  /**\n   * Callback method called when this client connects to the WebRTC signaling server.\n   * The callback implementation should not throw any exception.\n   * @method ConnectionListener#connected\n   * @abstract\n   * @param {string} clientId - The unique identifier of this WebRTC client.<br>This identifier is provided by the\n   * signaling server to uniquely identify each connected peer.\n   */\n  /**\n   * Callback method called when this client disconnects from the WebRTC signaling server.\n   * The callback implementation should not throw any exception.\n   * @method ConnectionListener#disconnected\n   * @abstract\n   */\n\n  /**\n   * Registers a connection listener that will be called each time the WebRTC API connects to or disconnects from the\n   * signaling server.\n   * @param {ConnectionListener} listener - The connection listener to register.\n   * @returns {boolean} true in case of success (or if the listener was already registered), or false if the listener\n   * doesn't implement all callback functions and cannot be registered.\n   */\n  registerConnectionListener(listener) {\n    if (!listener || (typeof (listener) !== \"object\") ||\n      (typeof (listener.connected) !== \"function\") ||\n      (typeof (listener.disconnected) !== \"function\")) {\n      return false;\n    }\n\n    if (!this._connectionListeners.includes(listener)) {\n      this._connectionListeners.push(listener);\n    }\n\n    return true;\n  }\n\n  /**\n   * Unregisters a connection listener.<br>\n   * The removed listener will never be called again and can be garbage collected.\n   * @param {ConnectionListener} listener - The connection listener to unregister.\n   * @returns {boolean} true if the listener is found and unregistered, or false if the listener was not previously\n   * registered.\n   */\n  unregisterConnectionListener(listener) {\n    const idx = this._connectionListeners.indexOf(listener);\n    if (idx >= 0) {\n      this._connectionListeners.splice(idx, 1);\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Unregisters all previously registered connection listeners.\n   */\n  unregisterAllConnectionListeners() {\n    this._connectionListeners = [];\n  }\n\n  /**\n   * Creates a new producer session.\n   * <p>You can only create one producer session at a time.<br>\n   * To request streaming from a new stream you will first need to close the previous producer session.</p>\n   * <p>You can only request a producer session while you are connected to the signaling server. You can use the\n   * {@link ConnectionListener} interface and {@link GstWebRTCAPI#registerConnectionListener} method to\n   * listen to the connection state.</p>\n   * @param {MediaStream} stream - The audio/video stream to offer as a producer through WebRTC.\n   * @returns {ProducerSession} The created producer session or null in case of error. To start streaming,\n   * you still need to call {@link ProducerSession#start} after adding on the returned session all the event\n   * listeners you may need.\n   */\n  createProducerSession(stream) {\n    if (this._channel) {\n      return this._channel.createProducerSession(stream);\n    }\n    return null;\n  }\n\n  createProducerSessionForConsumer(stream, consumerId) {\n    if (this._channel) {\n      return this._channel.createProducerSession(stream, consumerId);\n    }\n    return null;\n  }\n\n  /**\n   * Information about a remote peer registered by the signaling server.\n   * @typedef {object} Peer\n   * @readonly\n   * @property {string} id - The unique peer identifier set by the signaling server (always non-empty).\n   * @property {object} meta - Free-form object containing extra information about the peer (always non-null,\n   * but may be empty). Its content depends on your application.\n   */\n\n  /**\n   * Gets the list of all remote WebRTC producers available on the signaling server.\n   * <p>The remote producers list is only populated once you've connected to the signaling server. You can use the\n   * {@link ConnectionListener} interface and {@link GstWebRTCAPI#registerConnectionListener} method to\n   * listen to the connection state.</p>\n   * @returns {Peer[]} The list of remote WebRTC producers available.\n   */\n  getAvailableProducers() {\n    return Object.values(this._producers);\n  }\n\n  /**\n   * Gets the list of all remote WebRTC consumers available on the signaling server.\n   * <p>The remote consumer list is only populated once you've connected to the signaling server. You can use the\n   * {@link ConnectionListener} interface and {@link GstWebRTCAPI#registerConnectionListener} method to\n   * listen to the connection state.</p>\n   * @returns {Peer[]} The list of remote WebRTC consumers available.\n   */\n  getAvailableConsumers() {\n    return Object.values(this._consumers);\n  }\n\n  /**\n   * @interface PeerListener\n   */\n  /**\n   * Callback method called when a remote producer is added on the signaling server.\n   * The callback implementation should not throw any exception.\n   * @method PeerListener#producerAdded\n   * @abstract\n   * @param {Peer} producer - The remote producer added on server-side.\n   */\n  /**\n   * Callback method called when a remote producer is removed from the signaling server.\n   * The callback implementation should not throw any exception.\n   * @method PeerListener#producerRemoved\n   * @abstract\n   * @param {Peer} producer - The remote producer removed on server-side.\n   */\n  /**\n   * Callback method called when a remote consumer is added on the signaling server.\n   * The callback implementation should not throw any exception.\n   * @method PeerListener#consumerAdded\n   * @abstract\n   * @param {Peer} consumer - The remote consumer added on server-side.\n   * */\n  /**\n   * Callback method called when a remote consumer is removed from the signaling server.\n   * The callback implementation should not throw any exception.\n   * @method PeerListener#consumerRemoved\n   * @abstract\n   * @param {Peer} consumer - The remote consumer removed on server-side.\n   * */\n\n  /**\n   * Registers a listener that will be called each time a peer is added or removed on the signaling server.\n   * The listener can implement all or only some of the callback methods.\n   * @param {PeerListener} listener - The peer listener to register.\n   * @returns {boolean} true in case of success (or if the listener was already registered), or false if the listener\n   * doesn't implement any methods from PeerListener and cannot be registered.\n   */\n  registerPeerListener(listener) {\n    // refuse if no methods from PeerListener are implemented\n    if (!listener || (typeof (listener) !== \"object\") ||\n      ((typeof (listener.producerAdded) !== \"function\") &&\n       (typeof (listener.producerRemoved) !== \"function\") &&\n       (typeof (listener.consumerAdded) !== \"function\") &&\n       (typeof (listener.consumerRemoved) !== \"function\"))) {\n      return false;\n    }\n\n    if (!this._peerListeners.includes(listener)) {\n      this._peerListeners.push(listener);\n    }\n\n    return true;\n  }\n\n  /**\n   * Unregisters a peer listener.<br>\n   * The removed listener will never be called again and can be garbage collected.\n   * @param {PeerListener} listener - The peer listener to unregister.\n   * @returns {boolean} true if the listener is found and unregistered, or false if the listener was not previously\n   * registered.\n   */\n  unregisterPeerListener(listener) {\n    const idx = this._peerListeners.indexOf(listener);\n    if (idx >= 0) {\n      this._peerListeners.splice(idx, 1);\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Unregisters all previously registered peer listeners.\n   */\n  unregisterAllPeerListeners() {\n    this._peerListeners = [];\n  }\n\n  /**\n   * Creates a consumer session by connecting the local client to a remote WebRTC producer.\n   * <p>You can only create one consumer session per remote producer.</p>\n   * <p>You can only request a new consumer session while you are connected to the signaling server. You can use the\n   * {@link ConnectionListener} interface and {@link GstWebRTCAPI#registerConnectionListener} method to\n   * listen to the connection state.</p>\n   * @param {string} producerId - The unique identifier of the remote producer to connect to.\n   * @returns {ConsumerSession} The WebRTC session between the selected remote producer and this local\n   * consumer, or null in case of error. To start connecting and receiving the remote streams, you still need to call\n   * {@link ConsumerSession#connect} after adding on the returned session all the event listeners you may\n   * need.\n   */\n  createConsumerSession(producerId) {\n    if (this._channel) {\n      return this._channel.createConsumerSession(producerId);\n    }\n    return null;\n  }\n\n  /**\n   * Creates a consumer session by connecting the local client to a remote WebRTC producer and creating the offer.\n   * <p>See {@link GstWebRTCAPI#createConsumerSession} for more information</p>\n   * @param {string} producerId - The unique identifier of the remote producer to connect to.\n   * @param {RTCOfferOptions} offerOptions - An object to use when creating the offer.\n   * @returns {ConsumerSession} The WebRTC session between the selected remote producer and this local\n   * consumer, or null in case of error. To start connecting and receiving the remote streams, you still need to call\n   * {@link ConsumerSession#connect} after adding on the returned session all the event listeners you may\n   * need.\n   */\n  createConsumerSessionWithOfferOptions(producerId, offerOptions) {\n    if (this._channel) {\n      return this._channel.createConsumerSession(producerId, offerOptions);\n    }\n    return null;\n  }\n\n  connectChannel() {\n    if (this._channel) {\n      const oldChannel = this._channel;\n      this._channel = null;\n      oldChannel.close();\n      for (const key in this._producers) {\n        this.triggerProducerRemoved(key);\n      }\n      for (const key in this._consumers) {\n        this.triggerConsumerRemoved(key);\n      }\n      this._producers = {};\n      this._consumers = {};\n      this.triggerDisconnected();\n    }\n\n    this._channel = new ComChannel(\n      this._config.signalingServerUrl,\n      this._config.meta,\n      this._config.webrtcConfig\n    );\n\n    this._channel.addEventListener(\"error\", (event) => {\n      if (event.target === this._channel) {\n        console.error(event.message, event.error);\n      }\n    });\n\n    this._channel.addEventListener(\"closed\", (event) => {\n      if (event.target !== this._channel) {\n        return;\n      }\n      this._channel = null;\n      for (const key in this._producers) {\n        this.triggerProducerRemoved(key);\n      }\n      for (const key in this._consumers) {\n        this.triggerConsumerRemoved(key);\n      }\n      this._producers = {};\n      this._consumers = {};\n      this.triggerDisconnected();\n      if (this._config.reconnectionTimeout > 0) {\n        window.setTimeout(() => {\n          this.connectChannel();\n        }, this._config.reconnectionTimeout);\n      }\n    });\n\n    this._channel.addEventListener(\"ready\", (event) => {\n      if (event.target === this._channel) {\n        this.triggerConnected(this._channel.channelId);\n      }\n    });\n\n    this._channel.addEventListener(\"peerAdded\", (event) => {\n      if (event.target !== this._channel) {\n        return;\n      }\n\n      if (event.detail.role === \"producer\") {\n        this.triggerProducerAdded(event.detail.peer);\n      } else {\n        this.triggerConsumerAdded(event.detail.peer);\n      }\n    });\n\n    this._channel.addEventListener(\"peerRemoved\", (event) => {\n      if (event.target !== this._channel) {\n        return;\n      }\n\n      if (event.detail.role === \"producer\") {\n        this.triggerProducerRemoved(event.detail.peerId);\n      } else {\n        this.triggerConsumerRemoved(event.detail.peerId);\n      }\n    });\n  }\n\n  triggerConnected(clientId) {\n    for (const listener of this._connectionListeners) {\n      try {\n        listener.connected(clientId);\n      } catch (ex) {\n        console.error(\"a listener callback should not throw any exception\", ex);\n      }\n    }\n  }\n\n  triggerDisconnected() {\n    for (const listener of this._connectionListeners) {\n      try {\n        listener.disconnected();\n      } catch (ex) {\n        console.error(\"a listener callback should not throw any exception\", ex);\n      }\n    }\n  }\n\n  triggerProducerAdded(producer) {\n    if (producer.id in this._producers) {\n      return;\n    }\n\n    this._producers[producer.id] = producer;\n    for (const listener of this._peerListeners) {\n      if (!listener.producerAdded) {\n        continue;\n      }\n\n      try {\n        listener.producerAdded(producer);\n      } catch (ex) {\n        console.error(\"a listener callback should not throw any exception\", ex);\n      }\n    }\n  }\n\n  triggerProducerRemoved(producerId) {\n    if (!(producerId in this._producers)) {\n      return;\n    }\n\n    const producer = this._producers[producerId];\n    delete this._producers[producerId];\n\n    for (const listener of this._peerListeners) {\n      if (!listener.producerRemoved) {\n        continue;\n      }\n\n      try {\n        listener.producerRemoved(producer);\n      } catch (ex) {\n        console.error(\"a listener callback should not throw any exception\", ex);\n      }\n    }\n  }\n\n  triggerConsumerAdded(consumer) {\n    if (consumer.id in this._consumers) {\n      return;\n    }\n\n    this._consumers[consumer.id] = consumer;\n    for (const listener of this._peerListeners) {\n      if (!listener.consumerAdded) {\n        continue;\n      }\n\n      try {\n        listener.consumerAdded(consumer);\n      } catch (ex) {\n        console.error(\"a listener callback should not throw any exception\", ex);\n      }\n    }\n  }\n\n  triggerConsumerRemoved(consumerId) {\n    if (!(consumerId in this._consumers)) {\n      return;\n    }\n\n    const consumer = this._consumers[consumerId];\n    delete this._consumers[consumerId];\n\n    for (const listener of this._peerListeners) {\n      if (!listener.consumerRemoved) {\n        continue;\n      }\n\n      try {\n        listener.consumerRemoved(consumer);\n      } catch (ex) {\n        console.error(\"a listener callback should not throw any exception\", ex);\n      }\n    }\n  }\n}\n\nGstWebRTCAPI.SessionState = SessionState;\n\nexport default GstWebRTCAPI;\n","/*\n * gstwebrtc-api\n *\n * Copyright (C) 2022 Igalia S.L. <info@igalia.com>\n *   Author: Loc Le Page <llepage@igalia.com>\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/.\n */\n\nimport \"webrtc-adapter\";\nimport GstWebRTCAPI from \"./gstwebrtc-api.js\";\n\n/**\n * @external MediaStream\n * @see https://developer.mozilla.org/en-US/docs/Web/API/MediaStream\n */\n/**\n * @external RTCPeerConnection\n * @see https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection\n */\n/**\n * @external RTCDataChannel\n * @see https://developer.mozilla.org/en-US/docs/Web/API/RTCDataChannel\n */\n/**\n * @external RTCOfferOptions\n * @see https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createOffer#options\n */\n/**\n * @external EventTarget\n * @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget\n */\n/**\n * @external Event\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Event\n */\n/**\n * @external ErrorEvent\n * @see https://developer.mozilla.org/en-US/docs/Web/API/ErrorEvent\n */\n/**\n * @external CustomEvent\n * @see https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent\n */\n/**\n * @external Error\n * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error\n */\n/**\n * @external HTMLVideoElement\n * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement\n */\n\nif (!window.GstWebRTCAPI) {\n  window.GstWebRTCAPI = GstWebRTCAPI;\n}\n\nexport default GstWebRTCAPI;\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","logDisabled_","deprecationWarnings_","extractVersion","uastring","expr","pos","match","length","parseInt","wrapPeerConnectionEvent","window","eventNameToWrap","wrapper","RTCPeerConnection","proto","nativeAddEventListener","addEventListener","nativeEventName","cb","apply","this","arguments","wrappedCallback","e","modifiedEvent","handleEvent","_eventMap","Map","set","nativeRemoveEventListener","removeEventListener","has","unwrappedCb","delete","size","keys","configurable","disableLog","bool","Error","disableWarnings","log","console","deprecated","oldMethod","newMethod","warn","isObject","val","toString","compactObject","data","reduce","accumulator","isObj","isEmptyObject","undefined","assign","walkStats","stats","base","resultSet","id","forEach","name","endsWith","filterStats","result","track","outbound","streamStatsType","filteredResult","trackStats","type","trackIdentifier","push","trackStat","trackId","logging","shimGetUserMedia","browserDetails","navigator","mediaDevices","constraintsToChrome_","c","mandatory","optional","cc","r","ideal","exact","min","max","oldname_","prefix","charAt","toUpperCase","slice","oc","mix","advanced","concat","shimConstraints_","constraints","func","version","JSON","parse","stringify","audio","remap","a","b","video","face","facingMode","getSupportedFacingModeLies","getSupportedConstraints","matches","enumerateDevices","then","devices","dev","filter","d","kind","find","some","label","toLowerCase","includes","deviceId","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","message","constraint","constraintName","getUserMedia","onSuccess","onError","webkitGetUserMedia","bind","origGetUserMedia","cs","stream","getAudioTracks","getVideoTracks","getTracks","stop","DOMException","Promise","reject","shimGetDisplayMedia","getSourceId","getDisplayMedia","sourceId","widthSpecified","width","heightSpecified","height","frameRateSpecified","frameRate","chromeMediaSource","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","error","shimMediaStream","MediaStream","webkitMediaStream","shimOnTrack","_ontrack","f","origSetRemoteDescription","setRemoteDescription","_ontrackpoly","te","receiver","getReceivers","event","Event","transceiver","streams","dispatchEvent","shimGetSendersWithDtmf","shimSenderWithDtmf","pc","dtmf","_dtmf","createDTMFSender","_pc","getSenders","_senders","origAddTrack","addTrack","sender","origRemoveTrack","removeTrack","idx","indexOf","splice","origAddStream","addStream","origRemoveStream","removeStream","s","RTCRtpSender","origGetSenders","senders","shimGetStats","origGetStats","getStats","selector","onSucc","onErr","fixChromeStats_","response","standardReport","report","standardStats","timestamp","localcandidate","remotecandidate","names","stat","makeMapStats","map","successCallbackWrapper_","resolve","shimSenderReceiverGetStats","RTCRtpReceiver","origGetReceivers","receivers","srcElement","MediaStreamTrack","err","shimAddTrackRemoveTrackWithNative","getLocalStreams","_shimmedLocalStreams","streamId","existingSenders","newSenders","newSender","shimAddTrackRemoveTrack","origGetLocalStreams","nativeStreams","_reverseStreams","_streams","newStream","replaceInternalStreamId","description","sdp","internalId","externalStream","internalStream","replace","RegExp","RTCSessionDescription","signalingState","t","oldStream","method","nativeMethod","methodObj","args","desc","origSetLocalDescription","setLocalDescription","replaceExternalStreamId","origLocalDescription","getOwnPropertyDescriptor","streamid","shimPeerConnection","webkitRTCPeerConnection","RTCIceCandidate","fixNegotiationNeeded","target","getConfiguration","sdpSemantics","nativeGetUserMedia","getSettings","nativeGetSettings","applyConstraints","nativeApplyConstraints","preferredMediaSource","code","mediaSource","RTCTrackEvent","mozRTCPeerConnection","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","nativeGetStats","i","shimSenderGetStats","shimReceiverGetStats","shimRemoveStream","shimRTCDataChannel","DataChannel","RTCDataChannel","shimAddTransceiver","origAddTransceiver","addTransceiver","setParametersPromises","sendEncodings","shouldPerformCheck","encodingParam","test","rid","TypeError","parseFloat","scaleResolutionDownBy","RangeError","maxFramerate","params","getParameters","encodings","setParameters","catch","shimGetParameters","origGetParameters","shimCreateOffer","origCreateOffer","createOffer","all","finally","shimCreateAnswer","origCreateAnswer","createAnswer","shimLocalStreamsAPI","_localStreams","_addTrack","index","tracks","shimRemoteStreamsAPI","getRemoteStreams","_remoteStreams","_onaddstream","_onaddstreampoly","shimCallbacksAPI","addIceCandidate","successCallback","failureCallback","options","promise","withCallback","candidate","_getUserMedia","shimConstraints","errcb","shimRTCIceServerUrls","OrigPeerConnection","pcConfig","pcConstraints","iceServers","newIceServers","server","urls","url","generateCertificate","shimTrackEventTransceiver","shimCreateOfferLegacy","offerOptions","offerToReceiveAudio","audioTransceiver","getTransceivers","direction","setDirection","offerToReceiveVideo","videoTransceiver","shimAudioContext","AudioContext","webkitAudioContext","SDPUtils","Math","random","substring","localCName","generateIdentifier","splitLines","blob","trim","split","line","splitSections","part","getDescription","sections","getMediaSections","shift","matchPrefix","parseCandidate","parts","foundation","component","protocol","priority","ip","address","port","relatedAddress","relatedPort","tcpType","ufrag","usernameFragment","writeCandidate","join","parseIceOptions","parseRtpMap","parsed","payloadType","clockRate","channels","numChannels","writeRtpMap","codec","pt","preferredPayloadType","parseExtmap","uri","attributes","writeExtmap","headerExtension","preferredId","parseFmtp","kv","j","writeFmtp","parameters","param","parseRtcpFb","parameter","writeRtcpFb","lines","rtcpFeedback","fb","parseSsrcMedia","sp","ssrc","colon","attribute","parseSsrcGroup","semantics","ssrcs","getMid","mediaSection","mid","parseFingerprint","algorithm","getDtlsParameters","sessionpart","role","fingerprints","writeDtlsParameters","setupType","fp","parseCryptoLine","tag","cryptoSuite","keyParams","sessionParams","writeCryptoLine","writeCryptoKeyParams","parseCryptoKeyParams","keyMethod","keySalt","lifeTime","mkiValue","mkiLength","getCryptoParameters","getIceParameters","pwd","password","writeIceParameters","iceLite","parseRtpParameters","codecs","headerExtensions","fecMechanisms","rtcp","mline","profile","rtpmapline","fmtps","wildcardRtcpFb","existingFeedback","writeRtpDescription","caps","maxptime","extension","parseRtpEncodingParameters","encodingParameters","hasRed","hasUlpfec","primarySsrc","secondarySsrc","flows","apt","encParam","codecPayloadType","rtx","fec","mechanism","bandwidth","maxBitrate","parseRtcpParameters","rtcpParameters","remoteSsrc","cname","rsize","reducedSize","compound","mux","writeRtcpParameters","parseMsid","spec","planB","msidParts","parseSctpDescription","parseMLine","maxSizeLine","maxMessageSize","isNaN","sctpPort","fmt","sctpMapLines","writeSctpDescription","media","sctp","output","generateSessionId","substr","writeSessionBoilerplate","sessId","sessVer","sessUser","sessionId","getDirection","getKind","isRejected","parseOLine","username","sessionVersion","netType","addressType","isValidSDP","shimRTCIceCandidate","NativeRTCIceCandidate","nativeCandidate","parsedCandidate","toJSON","sdpMid","sdpMLineIndex","writable","shimRTCIceCandidateRelayProtocol","relayProtocol","shimMaxMessageSize","_sctp","browser","mLine","sctpInDescription","isFirefox","getRemoteFirefoxVersion","canSendMMS","remoteIsFirefox","canSendMaxMessageSize","getCanSendMaxMessageSize","remoteMMS","getMaxMessageSize","Number","POSITIVE_INFINITY","shimSendThrowTypeError","wrapDcSend","dc","origDataChannelSend","send","byteLength","readyState","origCreateDataChannel","createDataChannel","dataChannel","channel","shimConnectionState","completed","checking","iceConnectionState","_onconnectionstatechange","origMethod","_connectionstatechangepoly","_lastConnectionState","connectionState","newEvent","removeExtmapAllowMixed","nativeSRD","shimAddIceCandidateNullOrEmpty","nativeAddIceCandidate","shimParameterlessSetLocalDescription","nativeSetLocalDescription","shimChrome","shimFirefox","shimSafari","userAgent","mozGetUserMedia","isSecureContext","supportsUnifiedPlan","RTCRtpTransceiver","adapter","commonShim","browserShim","adapterFactory","freeze","meta","signalingServerUrl","reconnectionTimeout","webrtcConfig","bundlePolicy","SessionState","idle","connecting","streaming","closed","WebRTCSession","EventTarget","constructor","peerId","comChannel","super","_peerId","_sessionId","_comChannel","_state","_rtcPeerConnection","state","rtcPeerConnection","close","uniToKeySyms","kbEventCodesToKeySyms","knownKbEventCodes","Set","getKeysymString","keySym","keyCodeUni","charCodeAt","eventsNames","mouseEventsNames","mousemove","mousedown","mouseup","touchEventsNames","touchstart","touchend","touchmove","touchcancel","keyboardEventsNames","keydown","keyup","getModifiers","modifiers","altKey","ctrlKey","metaKey","shiftKey","RemoteController","rtcDataChannel","consumerSession","_rtcDataChannel","_consumerSession","_videoElement","_videoElementComputedStyle","_videoElementKeyboard","_lastTouchEventTimestamp","_requestCounter","ErrorEvent","msg","CustomEvent","detail","ex","videoElement","attachVideoElement","element","HTMLVideoElement","getComputedStyle","eventName","setAttribute","previousElement","removeAttribute","sendControlRequest","request","_sendGstNavigationEvent","_computeVideoMousePosition","mousePos","x","y","videoWidth","videoHeight","padding","paddingLeft","paddingRight","paddingTop","paddingBottom","offsetX","offsetY","clientRect","getBoundingClientRect","border","left","borderLeftWidth","top","borderTopWidth","clientX","clientY","videoOffset","clientWidth","clientHeight","ratio","invRatio","preventDefault","delta_x","deltaX","delta_y","deltaY","modifier_state","button","focus","touch","changedTouches","identifier","pressure","force","timeStamp","_remoteController","_pendingCandidates","_mungeStereoHack","_offerOptions","mungeStereoHack","enable","remoteController","connect","ensurePeerConnection","offer","localDescription","onSessionStarted","ice","connection","ontrack","streamsChanged","ondatachannel","previousController","onicecandidate","mungeStereo","offerSdp","answerSdp","stereoRegexp","stereoPayloads","m","matchAll","payloadMatch","add","payload","isStereoRegexp","replaceAll","onSessionPeerMessage","ClientSession","ProducerSession","consumerId","_stream","_clientSessions","_consumerId","start","roles","clientSession","values","onProducerRegistered","onStartSessionMessage","session","onEndSessionMessage","SignallingServerMessageType","welcome","peerStatusChanged","list","listConsumers","sessionStarted","peer","startSession","endSession","normalizePeer","excludedId","normalizedPeer","ComChannel","_meta","_webrtcConfig","_ws","WebSocket","_ready","_channelId","_producerSession","_consumerSessions","_peers","onerror","onclose","closeAllConsumerSessions","onmessage","oldRoles","clearPeers","addPeers","producers","consumers","getConsumerSession","details","ready","channelId","producerSession","createProducerSession","createConsumerSession","producerId","items","item","userConfig","_channel","_producers","_consumers","_connectionListeners","_peerListeners","config","_config","connectChannel","registerConnectionListener","listener","unregisterConnectionListener","unregisterAllConnectionListeners","createProducerSessionForConsumer","getAvailableProducers","getAvailableConsumers","registerPeerListener","unregisterPeerListener","unregisterAllPeerListeners","createConsumerSessionWithOfferOptions","oldChannel","triggerProducerRemoved","triggerConsumerRemoved","triggerDisconnected","setTimeout","triggerConnected","triggerProducerAdded","triggerConsumerAdded","clientId","connected","disconnected","producer","producerAdded","producerRemoved","consumer","consumerAdded","consumerRemoved","GstWebRTCAPI"],"sourceRoot":""}